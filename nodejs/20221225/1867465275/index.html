
<!DOCTYPE html>
<html lang="zh-TW" class="scroll-smooth dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ä¸€æ­¥ä¸€æ­¥å¸¶ä½ ç”¨ Node.js ä¸Šå‚³æª”æ¡ˆåˆ° Firebase Storage | æ˜¯ Ray ä¸æ˜¯ Array</title>
  
  
    <link rel="icon" href="/images/favicon.png">
  

  <!-- Canonical URL -->
  <link rel="canonical" href="https://israynotarray.com/nodejs/20221225/1867465275/">

  <!-- SEO & Meta -->
  <meta name="description" content="ä¹‹å‰æœ‰åˆ†äº«éã€Œè¶…å®Œæ•´ Express Imgur å¥—ä»¶ä¸Šå‚³æ•™å­¸ã€ï¼Œæ‰€ä»¥é€™ä¸€ç¯‡å°±æ”¹ä¾†ä»‹ç´¹ Firebase Storage çš„ä¸Šå‚³æ•™å­¸ï¼Œè€Œé€™ä¸€ç¯‡æœƒç›¡å¯èƒ½æµç¨‹æ­¥é©Ÿéƒ½èªªæ˜æ¸…æ¥šï¼Œå› ç‚ºé€™ä¸€å¡Šä¹Ÿæ˜¯ç¨å¾®æœ‰ä¸€é»è¤‡é›œã€‚">
  <meta name="author" content="Ray">
  <meta name="keywords" content="å‰ç«¯, å¾Œç«¯, å…¨ç«¯, ç¶²é , é–‹ç™¼, æŠ€è¡“, ç¶²é é–‹ç™¼, å‰ç«¯é–‹ç™¼, å¾Œç«¯é–‹ç™¼, å…¨ç«¯é–‹ç™¼, JavaScript, HTML, CSS, ç¶“é©—åˆ†äº«, æ‰‹æœ­, ç­†è¨˜">
  
  <!-- Open Graph -->
  <meta property="og:type" content="article">
  <meta property="og:title" content="ä¸€æ­¥ä¸€æ­¥å¸¶ä½ ç”¨ Node.js ä¸Šå‚³æª”æ¡ˆåˆ° Firebase Storage">
  <meta property="og:url" content="https://israynotarray.com/nodejs/20221225/1867465275/">
  <meta property="og:site_name" content="æ˜¯ Ray ä¸æ˜¯ Array">
  <meta property="og:description" content="ä¹‹å‰æœ‰åˆ†äº«éã€Œè¶…å®Œæ•´ Express Imgur å¥—ä»¶ä¸Šå‚³æ•™å­¸ã€ï¼Œæ‰€ä»¥é€™ä¸€ç¯‡å°±æ”¹ä¾†ä»‹ç´¹ Firebase Storage çš„ä¸Šå‚³æ•™å­¸ï¼Œè€Œé€™ä¸€ç¯‡æœƒç›¡å¯èƒ½æµç¨‹æ­¥é©Ÿéƒ½èªªæ˜æ¸…æ¥šï¼Œå› ç‚ºé€™ä¸€å¡Šä¹Ÿæ˜¯ç¨å¾®æœ‰ä¸€é»è¤‡é›œã€‚">
  <meta property="og:locale" content="zh-TW">
  
  
    <meta property="og:image" content="https://i.imgur.com/mJkWN51.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
  

  
    <!-- Article Metadata -->
    <meta property="article:published_time" content="2022-12-25T09:00:00.000Z">
    
      <meta property="article:modified_time" content="2023-02-13T07:30:00.000Z">
    
    
      <meta property="article:author" content="Ray">
    
    
      
        <meta property="article:section" content="Nodejs">
      
    
    
      
        <meta property="article:tag" content="Node.js">
      
        <meta property="article:tag" content="Firebase">
      
        <meta property="article:tag" content="Express">
      
        <meta property="article:tag" content="Firebase Storage">
      
        <meta property="article:tag" content="Storage">
      
        <meta property="article:tag" content="multer">
      
        <meta property="article:tag" content="TinyPNG">
      
        <meta property="article:tag" content="Imgur">
      
    
  

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="ä¸€æ­¥ä¸€æ­¥å¸¶ä½ ç”¨ Node.js ä¸Šå‚³æª”æ¡ˆåˆ° Firebase Storage">
  <meta name="twitter:description" content="ä¹‹å‰æœ‰åˆ†äº«éã€Œè¶…å®Œæ•´ Express Imgur å¥—ä»¶ä¸Šå‚³æ•™å­¸ã€ï¼Œæ‰€ä»¥é€™ä¸€ç¯‡å°±æ”¹ä¾†ä»‹ç´¹ Firebase Storage çš„ä¸Šå‚³æ•™å­¸ï¼Œè€Œé€™ä¸€ç¯‡æœƒç›¡å¯èƒ½æµç¨‹æ­¥é©Ÿéƒ½èªªæ˜æ¸…æ¥šï¼Œå› ç‚ºé€™ä¸€å¡Šä¹Ÿæ˜¯ç¨å¾®æœ‰ä¸€é»è¤‡é›œã€‚">
  
    <meta name="twitter:image" content="https://i.imgur.com/mJkWN51.png">
  
  

  <!-- JSON-LD Structured Data -->
  <script type="application/ld+json">
  
  [{"@context":"https://schema.org","@type":"WebSite","name":"æ˜¯ Ray ä¸æ˜¯ Array","url":"https://israynotarray.com","description":"ğŸ‘¨â€ğŸ’» å—¨ï¼æˆ‘æ˜¯ Rayï¼Œä¸€å€‹ä¸æƒ³è¢«ç•¶æˆ Array çš„è»Ÿé«”å·¥ç¨‹å¸«ã€‚é€™è£¡åŒ¯é›†äº†æˆ‘çš„æŠ€è¡“ç­†è¨˜èˆ‡å¯¦æˆ°å¿ƒå¾—ã€‚æˆ‘ç›¸ä¿¡é€éåˆ†äº«ä¸åƒ…èƒ½å¹«åŠ©ä»–äººï¼Œä¹Ÿèƒ½è®“è‡ªå·±åœ¨è»Ÿé«”é–‹ç™¼çš„è·¯ä¸Šæ›´åŠ å …å®šã€‚","publisher":{"@type":"Organization","name":"æ˜¯ Ray ä¸æ˜¯ Array","logo":{"@type":"ImageObject","url":"https://israynotarray.com/images/logo.png"}}},{"@context":"https://schema.org","@type":"BlogPosting","headline":"ä¸€æ­¥ä¸€æ­¥å¸¶ä½ ç”¨ Node.js ä¸Šå‚³æª”æ¡ˆåˆ° Firebase Storage","url":"https://israynotarray.com/nodejs/20221225/1867465275/","datePublished":"2022-12-25T09:00:00.000Z","dateModified":"2023-02-13T07:30:00.000Z","description":"ä¹‹å‰æœ‰åˆ†äº«éã€Œè¶…å®Œæ•´ Express Imgur å¥—ä»¶ä¸Šå‚³æ•™å­¸ã€ï¼Œæ‰€ä»¥é€™ä¸€ç¯‡å°±æ”¹ä¾†ä»‹ç´¹ Firebase Storage çš„ä¸Šå‚³æ•™å­¸ï¼Œè€Œé€™ä¸€ç¯‡æœƒç›¡å¯èƒ½æµç¨‹æ­¥é©Ÿéƒ½èªªæ˜æ¸…æ¥šï¼Œå› ç‚ºé€™ä¸€å¡Šä¹Ÿæ˜¯ç¨å¾®æœ‰ä¸€é»è¤‡é›œã€‚","author":{"@type":"Person","name":"Ray","url":"https://israynotarray.com"},"publisher":{"@type":"Organization","name":"æ˜¯ Ray ä¸æ˜¯ Array","logo":{"@type":"ImageObject","url":"https://israynotarray.com/images/logo.png"}},"image":"https://i.imgur.com/mJkWN51.png","articleSection":["Nodejs"],"keywords":"Node.js, Firebase, Express, Firebase Storage, Storage, multer, TinyPNG, Imgur"},{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"é¦–é ","item":"https://israynotarray.com"},{"@type":"ListItem","position":2,"name":"Nodejs","item":"https://israynotarray.com/categories/nodejs/"},{"@type":"ListItem","position":3,"name":"ä¸€æ­¥ä¸€æ­¥å¸¶ä½ ç”¨ Node.js ä¸Šå‚³æª”æ¡ˆåˆ° Firebase Storage","item":"https://israynotarray.com/nodejs/20221225/1867465275/"}]}]
  </script>
  
  <!-- Google Fonts (Non-blocking) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;600&display=swap">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet" media="print" onload="this.media='all'">
  <noscript><link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet"></noscript>
  <!-- Press Start 2P (8-bit font for terminal easter egg) -->
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet" media="print" onload="this.media='all'">
  <noscript><link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet"></noscript>
  
  <!-- Bootstrap Icons (CDN) -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css" crossorigin="anonymous">
  
  <!-- Dark Mode Script (Prevent FOUC) - MUST run before CSS loads -->
  <script>
    (function() {
      const savedTheme = localStorage.getItem('theme');
      // Default to dark if no preference is saved (isDark = true)
      // Only switch to light if explicitly saved as 'light'
      const isLight = savedTheme === 'light';
      
      if (isLight) {
        document.documentElement.classList.remove('dark');
        document.documentElement.style.backgroundColor = '#f9fafb'; // gray-50
      } else {
        // Already has 'dark' class from HTML tag
        document.documentElement.classList.add('dark'); // Ensure it's there
        document.documentElement.style.backgroundColor = '#111827'; // gray-900
      }
    })();
  </script>

  <!-- Styles - Page Specific CSS -->
  
    
<link rel="stylesheet" href="/css/css-post-C7w1NhyW.css">

  
  
  <!-- Remove inline background after CSS loads -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      document.documentElement.style.backgroundColor = '';
    });
  </script>
  
  <!-- Scripts -->
  
<script src="/js/main-B2zwayVG.js"></script>

  
  <!-- Google AdSense -->
  
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4319471747130190" crossorigin="anonymous"></script>
  

  <!-- Google Analytics 4 -->
  
    
    
      <!-- GA4 Script (Respects DNT) -->
      <script>
        (function() {
          // Check for Do Not Track setting
          const dnt = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
          const doNotTrack = (dnt === "1" || dnt === "yes");
          
          if (!doNotTrack) {
            // Load GA4 script
            const script = document.createElement('script');
            script.async = true;
            script.src = 'https://www.googletagmanager.com/gtag/js?id=G-FC8R6QFRC3';
            document.head.appendChild(script);
            
            // Initialize GA4
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'G-FC8R6QFRC3', {
              'anonymize_ip': true,
              'cookie_flags': 'SameSite=None;Secure'
            });
            
            // Store gtag function globally
            window.gtag = gtag;
          } else {
            console.log('Google Analytics disabled due to Do Not Track setting');
          }
        })();
      </script>
    
  

  <!-- Microsoft Clarity -->
  
    <script type="text/javascript">
      (function(c,l,a,r,i,t,y){
          c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
          t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
          y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
      })(window, document, "clarity", "script", "h46z900dov");
    </script>
  

  <!-- Math Support -->
  

<meta name="generator" content="Hexo 8.1.1"><link rel="alternate" href="/atom.xml" title="æ˜¯ Ray ä¸æ˜¯ Array" type="application/atom+xml">
</head>


<script defer src="https://cdn.jsdelivr.net/npm/algoliasearch@4.20.0/dist/algoliasearch-lite.umd.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/instantsearch.js@4.60.0/dist/instantsearch.production.min.js"></script>


<body class="bg-gray-50 dark:bg-gray-900 text-gray-800 dark:text-gray-200 font-sans antialiased transition-colors duration-300">

  <!-- Mobile Top Navbar -->
  <div id="mobile-navbar" class="lg:hidden fixed top-0 left-0 w-full z-30 transition-all duration-300">
  <div class="flex items-center justify-between px-4 py-3">
    <!-- Site Title -->
    <a href="/" class="text-lg font-bold text-gray-900 dark:text-white font-sans">
      æ˜¯ Ray ä¸æ˜¯ Array
    </a>

    <!-- Mobile Actions -->
    <div class="flex items-center gap-2">
      
      <!-- Mobile Search Button -->
      <button id="mobile-search-trigger" aria-label="Open search" class="p-2 text-gray-600 dark:text-gray-300 hover:text-primary-500 dark:hover:text-primary-400 transition-colors rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800">
        <i class="bi bi-search text-xl"></i>
      </button>
      

      <!-- Mobile Menu Button -->
      <button id="mobile-menu-btn" aria-label="Toggle mobile menu" class="p-2 text-gray-600 dark:text-gray-300 hover:text-primary-500 dark:hover:text-primary-400 transition-colors rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800">
        <i class="bi bi-list text-2xl"></i>
      </button>
    </div>
  </div>
</div>


  <!-- Mobile Menu Overlay -->
  <div id="mobile-menu-overlay" class="fixed inset-0 bg-gray-900/60 backdrop-blur-sm z-30 hidden transition-opacity duration-300 lg:hidden"></div>

  <div class="min-h-screen flex flex-col lg:flex-row max-w-[1600px] mx-auto pt-16 lg:pt-0">
    
    <!-- Left Sidebar (Navigation & Bio) -->
    <aside class="fixed inset-y-0 left-0 z-40 w-64 h-screen overflow-y-auto bg-white dark:bg-gray-900 border-r border-gray-200 dark:border-gray-800 transition-transform duration-300 ease-in-out transform -translate-x-full lg:translate-x-0 lg:static lg:w-1/5 lg:h-screen lg:sticky lg:top-0 lg:flex lg:flex-col">
      <div class="p-6 pb-32 lg:pb-6">
        
<!-- æ–‡ç« é ç²¾ç°¡ç‰ˆï¼šé ­åƒ+åå­— + èªéŒ„ + åœ–æ¨™å°èˆª + å»£å‘Š + Dark Mode -->
<div class="flex flex-col items-center lg:items-start space-y-5">

  <!-- Avatar + Name (æ•´åˆæˆä¸€è¡Œ) -->
  <a href="/" class="flex items-center gap-3 group w-full">
    <img src="/images/octocat.webp" alt="Ray" class="w-12 h-12 rounded-full border-2 border-primary-100 dark:border-primary-900 shadow-sm object-cover transition-all duration-300 group-hover:shadow-lg group-hover:scale-105">
    <span class="text-lg font-bold text-gray-900 dark:text-white group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors">
      æ˜¯ Ray ä¸æ˜¯ Array
    </span>
  </a>

  <!-- Mini Quote (ä¿ç•™åŸæœ¬é¢¨æ ¼) -->
  <div class="w-full p-3 bg-gradient-to-br from-primary-50 to-primary-100 dark:from-primary-900/20 dark:to-primary-800/20 rounded-xl border border-primary-200 dark:border-primary-800 shadow-sm">
    <p id="post-random-quote" class="text-[10px] text-gray-700 dark:text-gray-300" style="font-family: 'Press Start 2P', monospace; line-height: 1.8;">
      Loading...
    </p>
  </div>

  <!-- Navigation (ç·Šæ¹Šç‰ˆï¼Œä¿ç•™æ–‡å­—) -->
  <nav class="w-full">
    <ul class="space-y-0.5">
      
        
        
        
        <li>
          <a href="/" class="flex items-center px-3 py-2 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-primary-50 dark:hover:bg-primary-900/20 hover:text-primary-600 dark:hover:text-primary-400 transition-all duration-200 group text-sm">
            <i class="bi bi-house-fill w-5 text-center mr-2 text-gray-400 group-hover:text-primary-500 transition-colors text-xs"></i>
            <span class="font-medium text-xs">é¦–é </span>
          </a>
        </li>
      
        
        
        
        <li>
          <a href="/tags/" class="flex items-center px-3 py-2 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-primary-50 dark:hover:bg-primary-900/20 hover:text-primary-600 dark:hover:text-primary-400 transition-all duration-200 group text-sm">
            <i class="bi bi-tags-fill w-5 text-center mr-2 text-gray-400 group-hover:text-primary-500 transition-colors text-xs"></i>
            <span class="font-medium text-xs">æ¨™ç±¤</span>
          </a>
        </li>
      
        
        
        
        <li>
          <a href="/categories/" class="flex items-center px-3 py-2 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-primary-50 dark:hover:bg-primary-900/20 hover:text-primary-600 dark:hover:text-primary-400 transition-all duration-200 group text-sm">
            <i class="bi bi-grid-fill w-5 text-center mr-2 text-gray-400 group-hover:text-primary-500 transition-colors text-xs"></i>
            <span class="font-medium text-xs">åˆ†é¡</span>
          </a>
        </li>
      
        
        
        
        <li>
          <a href="/archives/" class="flex items-center px-3 py-2 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-primary-50 dark:hover:bg-primary-900/20 hover:text-primary-600 dark:hover:text-primary-400 transition-all duration-200 group text-sm">
            <i class="bi bi-archive-fill w-5 text-center mr-2 text-gray-400 group-hover:text-primary-500 transition-colors text-xs"></i>
            <span class="font-medium text-xs">æ­¸æª”</span>
          </a>
        </li>
      
        
        
        
        <li>
          <a href="/atom.xml" class="flex items-center px-3 py-2 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-primary-50 dark:hover:bg-primary-900/20 hover:text-primary-600 dark:hover:text-primary-400 transition-all duration-200 group text-sm">
            <i class="bi bi-rss-fill w-5 text-center mr-2 text-gray-400 group-hover:text-primary-500 transition-colors text-xs"></i>
            <span class="font-medium text-xs">RSS</span>
          </a>
        </li>
      
        
        
        
        <li>
          <a href="/links/" class="flex items-center px-3 py-2 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-primary-50 dark:hover:bg-primary-900/20 hover:text-primary-600 dark:hover:text-primary-400 transition-all duration-200 group text-sm">
            <i class="bi bi-link-45deg w-5 text-center mr-2 text-gray-400 group-hover:text-primary-500 transition-colors text-xs"></i>
            <span class="font-medium text-xs">æ›´å¤š</span>
          </a>
        </li>
      
    </ul>
  </nav>

  <!-- Left Sidebar Ad (æ–‡ç« é å°ˆå±¬) -->
  
    <div class="w-full bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-100 dark:border-gray-700 min-h-[250px] overflow-hidden relative">
      <!-- Fallback Text (Visible when AdBlock is on) -->
      <div class="absolute inset-0 flex items-center justify-center p-4 text-center">
        <p class="text-xs text-gray-400 dark:text-gray-500 leading-relaxed">
          æ•´ç†é€™äº›æŠ€è¡“ç­†è¨˜çœŸçš„å¾ˆèŠ±æ™‚é–“ï¼Œå¦‚æœä½ é¡˜æ„ <strong>é—œé–‰ Adblock</strong> æ”¯æŒæˆ‘ï¼Œæˆ‘æœƒæŠŠé€™ä»½æ„Ÿè¬è½‰æ›æˆæ›´å¤šã€Œè¸©å‘è½‰é¿å‘ã€çš„å…§å®¹çµ¦ä½ ï¼ãƒ½(ãƒ»âˆ€ãƒ»)ï¾‰
        </p>
      </div>
      <!-- Ad Unit (z-index higher than fallback) -->
      <div class="relative z-10 w-full min-h-[230px]">
        <span class="text-xs text-gray-400 uppercase tracking-wider block mb-2">Advertisement</span>
        <ins class="adsbygoogle"
             style="display:block;width:100%;"
             data-ad-client="ca-pub-4319471747130190"
             data-ad-slot="4559796060"
             data-ad-format="auto"
             data-full-width-responsive="true"></ins>
        <script>
             (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      </div>
    </div>
  

  <!-- Dark Mode Toggle (ç²¾ç°¡ç‰ˆ) -->
  <button id="theme-toggle" class="flex items-center justify-between px-3 py-2 rounded-lg bg-gray-100 dark:bg-gray-800 w-full transition-all duration-200 hover:bg-gray-200 dark:hover:bg-gray-700 cursor-pointer border-none text-left" role="switch" aria-label="Toggle dark mode" aria-checked="false">
    <div class="flex items-center gap-2">
      <i class="bi bi-moon-stars-fill text-gray-500 dark:text-gray-400 text-sm"></i>
      <span class="text-sm text-gray-600 dark:text-gray-400">Dark Mode</span>
    </div>
    <span class="theme-switch pointer-events-none" style="transform: scale(0.85);">
      <span class="theme-switch-slider">
        <i class="theme-switch-icon bi bi-moon-stars-fill"></i>
      </span>
    </span>
  </button>
</div>

<!-- Mini Quote Script for Post Page -->
<script>
  {
    const hexoConfig = window.hexo_config || {};
    const themeConfig = hexoConfig.theme || {};
    const terminalConfig = themeConfig.terminal || {};

    const quotes = terminalConfig.quotes || [
      'Code is like humor. When you have to explain it, it\'s bad.',
      'Debug æ˜¯æˆ‘çš„ cardioã€‚',
      'First, solve the problem. Then, write the code.'
    ];

    const quoteElement = document.getElementById('post-random-quote');
    if (quoteElement) {
      const randomQuote = quotes[Math.floor(Math.random() * quotes.length)];
      quoteElement.textContent = '"' + randomQuote + '"';
    }
  }
</script>



      </div>
    </aside>

    <!-- Main Content -->
    <main class="w-full lg:w-3/5 px-4 lg:px-8 py-8 min-h-screen">
      <article class="bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700 overflow-hidden">
  
  <!-- Post Header Ad Slot (In Article Ad) -->
  
    <div class="w-full min-h-[300px] bg-gray-50 dark:bg-gray-900 p-4 text-center border-b border-gray-100 dark:border-gray-700 overflow-hidden relative">
      <!-- Fallback Text (Visible when AdBlock is on) -->
      <div class="absolute inset-0 flex items-center justify-center p-4 text-center">
        <p class="text-xs text-gray-400 dark:text-gray-500 leading-relaxed">
          æ•´ç†é€™äº›æŠ€è¡“ç­†è¨˜çœŸçš„å¾ˆèŠ±æ™‚é–“ï¼Œå¦‚æœä½ é¡˜æ„ <strong>é—œé–‰ Adblock</strong> æ”¯æŒæˆ‘ï¼Œæˆ‘æœƒæŠŠé€™ä»½æ„Ÿè¬è½‰æ›æˆæ›´å¤šã€Œè¸©å‘è½‰é¿å‘ã€çš„å…§å®¹çµ¦ä½ ï¼ãƒ½(ãƒ»âˆ€ãƒ»)ï¾‰
        </p>
      </div>
      <!-- Ad Unit (z-index higher than fallback) -->
      <div class="relative z-10 w-full min-h-[280px]">
        <span class="text-xs text-gray-400 uppercase tracking-wider block mb-2">Advertisement</span>
        <!-- ArrayException_In_Article -->
        <ins class="adsbygoogle"
             style="display:block;min-width:300px;width:100%;"
             data-ad-client="ca-pub-4319471747130190"
             data-ad-slot="4381452921"
             data-ad-format="auto"
             data-full-width-responsive="true"></ins>
        <script>
             (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      </div>
    </div>
  

  <div class="p-6">
    <!-- Post Header -->
    <header class="mb-8 text-center">
      <div class="flex items-center justify-center text-sm text-gray-500 dark:text-gray-400 mb-4 space-x-4">
        <span class="flex items-center">
          <i class="bi bi-calendar3 mr-2"></i>
          2022-12-25
        </span>
        
          <span class="flex items-center">
            <i class="bi bi-folder mr-2"></i>
            
              <a href="/categories/nodejs/" class="hover:text-primary-500 transition-colors">Nodejs</a>
              
            
          </span>
        
      </div>

      <h1 class="text-3xl lg:text-4xl font-bold text-gray-900 dark:text-white mb-6 leading-tight">
        ä¸€æ­¥ä¸€æ­¥å¸¶ä½ ç”¨ Node.js ä¸Šå‚³æª”æ¡ˆåˆ° Firebase Storage
      </h1>

      <!-- Tags -->
      
        <div class="flex flex-wrap justify-center gap-2">
          
            <a href="/tags/Node-js/" class="px-3 py-1 bg-gray-100 dark:bg-gray-700 text-xs rounded-full text-gray-600 dark:text-gray-300 hover:bg-primary-500 hover:text-white transition-colors">
              #Node.js
            </a>
          
            <a href="/tags/Firebase/" class="px-3 py-1 bg-gray-100 dark:bg-gray-700 text-xs rounded-full text-gray-600 dark:text-gray-300 hover:bg-primary-500 hover:text-white transition-colors">
              #Firebase
            </a>
          
            <a href="/tags/Express/" class="px-3 py-1 bg-gray-100 dark:bg-gray-700 text-xs rounded-full text-gray-600 dark:text-gray-300 hover:bg-primary-500 hover:text-white transition-colors">
              #Express
            </a>
          
            <a href="/tags/Firebase-Storage/" class="px-3 py-1 bg-gray-100 dark:bg-gray-700 text-xs rounded-full text-gray-600 dark:text-gray-300 hover:bg-primary-500 hover:text-white transition-colors">
              #Firebase Storage
            </a>
          
            <a href="/tags/Storage/" class="px-3 py-1 bg-gray-100 dark:bg-gray-700 text-xs rounded-full text-gray-600 dark:text-gray-300 hover:bg-primary-500 hover:text-white transition-colors">
              #Storage
            </a>
          
            <a href="/tags/multer/" class="px-3 py-1 bg-gray-100 dark:bg-gray-700 text-xs rounded-full text-gray-600 dark:text-gray-300 hover:bg-primary-500 hover:text-white transition-colors">
              #multer
            </a>
          
            <a href="/tags/TinyPNG/" class="px-3 py-1 bg-gray-100 dark:bg-gray-700 text-xs rounded-full text-gray-600 dark:text-gray-300 hover:bg-primary-500 hover:text-white transition-colors">
              #TinyPNG
            </a>
          
            <a href="/tags/Imgur/" class="px-3 py-1 bg-gray-100 dark:bg-gray-700 text-xs rounded-full text-gray-600 dark:text-gray-300 hover:bg-primary-500 hover:text-white transition-colors">
              #Imgur
            </a>
          
        </div>
      
    </header>

    <!-- Post Content -->
    <div class="prose prose-lg prose-slate dark:prose-invert max-w-none">
      <!-- markdownlint-disable MD033 -->

<p><img src="https://i.imgur.com/mJkWN51.png" alt="Firebase Storage"></p>
<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä¹‹å‰æœ‰åˆ†äº«éã€Œ<a href="/nodejs/20220517/432259079/#Express-Imgur">è¶…å®Œæ•´ Express Imgur å¥—ä»¶ä¸Šå‚³æ•™å­¸</a>ã€ï¼Œæ‰€ä»¥é€™ä¸€ç¯‡å°±æ”¹ä¾†ä»‹ç´¹ Firebase Storage çš„ä¸Šå‚³æ•™å­¸ï¼Œè€Œé€™ä¸€ç¯‡æœƒç›¡å¯èƒ½æµç¨‹æ­¥é©Ÿéƒ½èªªæ˜æ¸…æ¥šï¼Œå› ç‚ºé€™ä¸€å¡Šä¹Ÿæ˜¯ç¨å¾®æœ‰ä¸€é»è¤‡é›œã€‚</p>
<blockquote>
<p><strong>Note</strong><br>ç•«é¢å¯èƒ½æœƒéš¨è‘— Firebase çš„æ›´æ–°è€Œæœ‰æ‰€ä¸åŒï¼Œä½†æ˜¯å¤§è‡´ä¸Šçš„æµç¨‹æ‡‰è©²æ˜¯ä¸€æ¨£çš„ã€‚</p>
</blockquote>
<h2 id="Firebase-äº‹å‰æº–å‚™"><a href="#Firebase-äº‹å‰æº–å‚™" class="headerlink" title="Firebase äº‹å‰æº–å‚™"></a>Firebase äº‹å‰æº–å‚™</h2><p>ä¸ç®¡æ€éº¼æ¨£ï¼Œæœ‰ä¸€äº›æµç¨‹é‚„æ˜¯å¿…é ˆå…ˆåšå¥½æ‰èƒ½é€²å…¥é–‹ç™¼ï¼Œæ‰€ä»¥å‰é¢å°±æœƒå…ˆå¸¶ä¸€ä¸‹ Firebase çš„äº‹å‰æº–å‚™ã€‚</p>
<h3 id="å»ºç«‹-Firebase-å°ˆæ¡ˆ"><a href="#å»ºç«‹-Firebase-å°ˆæ¡ˆ" class="headerlink" title="å»ºç«‹ Firebase å°ˆæ¡ˆ"></a>å»ºç«‹ Firebase å°ˆæ¡ˆ</h3><p>é¦–å…ˆé–‹å•Ÿ <a target="_blank" rel="noopener" href="https://firebase.google.com/">Firebase</a>ï¼Œä¸¦ä¸”é»é¸å³ä¸Šè§’çš„ã€Œè½‰åˆ°æ§åˆ¶å°ã€</p>
<p><img src="https://firebasestorage.googleapis.com/v0/b/welcomewebworld-4097b.appspot.com/o/blogImg%2Ffirebase%2Ffirebase-express%2F%E6%88%AA%E5%9C%96%202022-12-23%2022.34.31.png?alt=media&token=e4b53259-8a28-4062-a4c8-db33056e052d" alt="è½‰åˆ°æ§åˆ¶å°"></p>
<p>æ¥è‘—é»ã€Œæ–°å¢å°ˆæ¡ˆã€ã€ã€Œå»ºç«‹å°ˆæ¡ˆã€</p>
<p><img src="https://firebasestorage.googleapis.com/v0/b/welcomewebworld-4097b.appspot.com/o/blogImg%2Ffirebase%2Ffirebase-express%2F202212232237.jpg?alt=media&token=46e28e0c-f00d-40c4-a747-c7d56bd182fd" alt="æ–°å¢å°ˆæ¡ˆ"></p>
<p>ç•¶ä½ é»äº†ã€Œå»ºç«‹å°ˆæ¡ˆã€å¾Œï¼Œå°±æœƒè·³å‡ºä¸€å€‹æ»¿ç‰ˆçš„è¦–çª—ï¼Œé€™é‚Šå°±æ˜¯ä½ è¦è¼¸å…¥å°ˆæ¡ˆåç¨±çš„åœ°æ–¹ï¼ŒåŸºæœ¬ä¸Šä½ å¯ä»¥éš¨ä¾¿å–ï¼Œä½†æ˜¯æˆ‘é€™é‚Šå°±å–ã€ŒFirebase-Expressã€ï¼Œæ¥è‘—æŒ‰ä¸‹ã€Œç¹¼çºŒã€</p>
<p><img src="https://firebasestorage.googleapis.com/v0/b/welcomewebworld-4097b.appspot.com/o/blogImg%2Ffirebase%2Ffirebase-express%2F%E6%88%AA%E5%9C%96%202022-12-23%2022.44.13.png?alt=media&token=8f380d4c-20ab-4f82-972b-923d5d29f96c" alt="å°ˆæ¡ˆåç¨±"></p>
<p>ç¬¬äºŒæ­¥é©Ÿæ˜¯ Firebase å•ä½ è¦ä¸è¦é–‹å•Ÿ Google Analytics(åˆ†æ)ï¼Œä½†é€™é‚Šæˆ‘å€‘ä¸¦ä¸éœ€è¦ï¼Œæ‰€ä»¥å°±ã€Œé—œé–‰ã€ä¸¦æŒ‰ä¸‹ã€Œå»ºç«‹å°ˆæ¡ˆã€</p>
<p><img src="https://firebasestorage.googleapis.com/v0/b/welcomewebworld-4097b.appspot.com/o/blogImg%2Ffirebase%2Ffirebase-express%2F%E6%88%AA%E5%9C%96%202022-12-23%2022.48.20.png?alt=media&token=d8e5f50d-0a39-411a-8987-e97f121b07b4" alt="Google Analytics(åˆ†æ)"></p>
<p>å»ºç«‹éç¨‹æœƒç¨å¾®ç­‰ä¸€ä¸‹ï¼Œä½ å»ä¸Šå€‹å»æ‰€å°±å¥½äº†</p>
<p><img src="https://firebasestorage.googleapis.com/v0/b/welcomewebworld-4097b.appspot.com/o/blogImg%2Ffirebase%2Ffirebase-express%2F%E6%88%AA%E5%9C%96%202022-12-23%2022.49.19.png?alt=media&token=6d613fff-ebd2-4fd4-9f5e-74bb0180b8e5" alt="å»ºç«‹ä¸­"></p>
<p>æº–å‚™å¥½å¾Œï¼Œå°±æŒ‰ä¸€ä¸‹ã€Œç¹¼çºŒã€</p>
<p><img src="https://firebasestorage.googleapis.com/v0/b/welcomewebworld-4097b.appspot.com/o/blogImg%2Ffirebase%2Ffirebase-express%2F%E6%88%AA%E5%9C%96%202022-12-23%2022.49.55.png?alt=media&token=5f3f97a1-6cbe-44d0-856a-599c1c562da5" alt="æ–°å°ˆæ¡ˆå·²æº–å‚™å°±ç·’"></p>
<p>é€™æ™‚å€™ä½ æ‡‰è©²æœƒç›´æ¥é€²å…¥åˆ°ä½ çš„å°ˆæ¡ˆæ§åˆ¶å°ï¼Œåˆ°é€™é‚Šç‚ºæ­¢ä½ çš„ Firebase å°ˆæ¡ˆå°±æº–å‚™å®Œæˆäº†</p>
<p><img src="https://firebasestorage.googleapis.com/v0/b/welcomewebworld-4097b.appspot.com/o/blogImg%2Ffirebase%2Ffirebase-express%2F%E6%88%AA%E5%9C%96%202022-12-23%2022.50.39.png?alt=media&token=b2e18403-c7ea-4a9a-a6b3-00796973187f" alt="å®Œæˆ"></p>
<h3 id="è¨­å®š-Firebase-Storage"><a href="#è¨­å®š-Firebase-Storage" class="headerlink" title="è¨­å®š Firebase Storage"></a>è¨­å®š Firebase Storage</h3><p>æ¥ä¸‹ä¾†ä½ å¿…é ˆè¨­ç½® Firebase Storage çš„å„²å­˜å€åŸŸï¼Œæ‰€ä»¥è«‹ä½ é»ä¸€ä¸‹å·¦å´åŠŸèƒ½åˆ—è¡¨æ‰¾åˆ°ã€ŒStorageã€</p>
<p><img src="https://firebasestorage.googleapis.com/v0/b/welcomewebworld-4097b.appspot.com/o/blogImg%2Ffirebase%2Ffirebase-express%2F%E6%88%AA%E5%9C%96%202022-12-24%2012.46.32.png?alt=media&token=7c240880-dd87-4074-87dc-3e5295199a65" alt="storage"></p>
<p>æ¥è‘—é»ä¸€ä¸‹ç•«é¢ã€Œé–‹å§‹ä½¿ç”¨ã€</p>
<p><img src="https://firebasestorage.googleapis.com/v0/b/welcomewebworld-4097b.appspot.com/o/blogImg%2Ffirebase%2Ffirebase-express%2F%E6%88%AA%E5%9C%96%202022-12-24%2013.37.04.png?alt=media&token=20e7bafc-0973-42bb-bde2-258fa1b7ade8" alt="é–‹å§‹ä½¿ç”¨"></p>
<p>ç•¶ä½ é»äº†é–‹å§‹ä½¿ç”¨å¾Œï¼Œæœƒè·³å‡ºã€Œè¨­å®š Cloud Storageã€çš„è¦–çª—ï¼Œé€™é‚Šå»ºè­°é¸ã€Œä»¥æ­£å¼æ¨¡å¼å•Ÿå‹•ã€</p>
<p><img src="https://firebasestorage.googleapis.com/v0/b/welcomewebworld-4097b.appspot.com/o/blogImg%2Ffirebase%2Ffirebase-express%2F%E6%88%AA%E5%9C%96%202022-12-24%2014.57.00.png?alt=media&token=da01d5cf-ce40-4800-ae69-b650f25513f8" alt="ä»¥æ­£å¼æ¨¡å¼å•Ÿå‹•"></p>
<p>æ¥è‘—æœƒéœ€è¦é¸å– Storage çš„åœ°å€ï¼Œé€šå¸¸é è¨­æ˜¯ <code>us-central</code>ï¼Œè€Œé€™é‚Šæˆ‘å€‘æ²’æœ‰å¿…è¦å»èª¿æ•´ï¼Œæ‰€ä»¥ä½ å¯ä»¥ç›´æ¥æŒ‰ä¸‹ã€Œå®Œæˆã€</p>
<p><img src="https://firebasestorage.googleapis.com/v0/b/welcomewebworld-4097b.appspot.com/o/blogImg%2Ffirebase%2Ffirebase-express%2F%E6%88%AA%E5%9C%96%202022-12-24%2015.01.36.png?alt=media&token=bc70790f-f0c8-4dc7-863e-ec39b23fa4c5" alt="Storage åœ°å€"></p>
<p>éç¨‹ä¸­æœƒç¨å¾®ç­‰ä¸€ä¸‹â€¦</p>
<p><img src="https://firebasestorage.googleapis.com/v0/b/welcomewebworld-4097b.appspot.com/o/blogImg%2Ffirebase%2Ffirebase-express%2F%E6%88%AA%E5%9C%96%202022-12-24%2015.03.30.png?alt=media&token=047613d6-31a1-4c37-8b44-48e314cc0366" alt="ç­‰å¾…ä¸­..."></p>
<p>ç•¶ä½ çœ‹åˆ°é€™å€‹ç•«é¢ï¼Œå°±ä»£è¡¨ä½ çš„ Storage å·²ç¶“è¨­å®šå®Œæˆäº†</p>
<p><img src="https://firebasestorage.googleapis.com/v0/b/welcomewebworld-4097b.appspot.com/o/blogImg%2Ffirebase%2Ffirebase-express%2F%E6%88%AA%E5%9C%96%202022-12-24%2015.04.01.png?alt=media&token=b7ab7541-81f8-4551-a940-bcb67c2b78bc" alt="è¨­å®šå®Œæˆ"></p>
<blockquote>
<p><strong>Note</strong><br>ä½ å¦‚æœä¸æ‰“ç®—ä¸²æ¥å¾Œç«¯ API ä½ ä¹Ÿå¯ä»¥ç›´æ¥åœ¨é€™å€‹è¦–çª—ä¸Šå‚³åœ–ç‰‡ã€‚<br>ä½†æ˜¯å¦‚æœä½ æƒ³è¦ä¸²æ¥å¾Œç«¯ APIï¼Œé‚£ä½ å°±å¿…é ˆå¾€å¾Œçœ‹å”·ï¼</p>
</blockquote>
<h3 id="å–å¾—-Firebase-Admin-SDK"><a href="#å–å¾—-Firebase-Admin-SDK" class="headerlink" title="å–å¾— Firebase Admin SDK"></a>å–å¾— Firebase Admin SDK</h3><p>æ¥è‘—ç”±æ–¼æˆ‘å€‘éœ€è¦ä¸Šå‚³åœ–ç‰‡ï¼Œå› æ­¤æœƒä½¿ç”¨åˆ° Firebase Admin SDKï¼Œæ‰€ä»¥æ¥è‘—å°±ä¾†å–å¾—é€™å€‹ SDK å§ï¼</p>
<p>é¦–å…ˆé»ä¸€ä¸‹ä¸Šæ–¹ã€Œé½’è¼ªã€ &#x3D;&gt; ã€Œå°ˆæ¡ˆè¨­å®šã€</p>
<p><img src="https://firebasestorage.googleapis.com/v0/b/welcomewebworld-4097b.appspot.com/o/blogImg%2Ffirebase%2Ffirebase-express%2F%E6%88%AA%E5%9C%96%202022-12-23%2023.05.46.png?alt=media&token=7ad005bc-2a5a-4958-9c36-e09ee40b888c" alt="å°ˆæ¡ˆè¨­å®š"></p>
<p>æ¥è‘—å†é»ä¸€ä¸‹ã€Œæœå‹™å¸³è™Ÿã€ï¼Œä½ å°±å¯ä»¥çœ‹åˆ° Firebase Admin SDK çš„é é¢</p>
<p><img src="https://firebasestorage.googleapis.com/v0/b/welcomewebworld-4097b.appspot.com/o/blogImg%2Ffirebase%2Ffirebase-express%2F%E6%88%AA%E5%9C%96%202022-12-23%2023.29.37.png?alt=media&token=1a9b6822-90c2-41ad-8601-47df2e5e6dbf" alt="Firebase Admin SDK"></p>
<p>æœ€å¾Œä½ åªè¦æŒ‰ä¸€ä¸‹ã€Œç”¢ç”Ÿæ–°çš„ç§å¯†é‡‘é‘°ã€(ä½ å¯ä»¥ä¾ç…§ä½ çš„ç¨‹å¼èªè¨€ç”Ÿæˆç¯„ä¾‹ç¨‹å¼ç¢¼)ï¼Œå°±å¯ä»¥å–å¾—ä½ çš„ Firebase Admin SDK é‡‘é‘°ï¼Œæ¥è‘—è«‹æŠŠé€™ä»½ JSON æª”æ¡ˆä¿å­˜å¥½ï¼Œå¾Œé¢æˆ‘å€‘æœƒä½¿ç”¨ã€‚</p>
<blockquote>
<p><strong>Danger</strong><br>è«‹ä¸è¦éš¨æ„å°‡é‡‘é‘°æä¾›çµ¦åˆ¥äºº<br>è«‹ä¸è¦å°‡é€™å€‹é‡‘é‘°æ”¾åˆ°ä½ çš„ GitHub ä¸Šï¼ˆå¦‚æœä½ çœŸé€™æ¨£å¹¹ï¼Œè«‹ä½ æŠŠé€™å€‹å„²å­˜åº«åˆªé™¤ä¸¦é‡æ–°ç”Ÿæˆä¸€å€‹æ–°çš„é‡‘é‘°å§ã€‚ï¼‰</p>
</blockquote>
<p>åˆ°ç›®å‰ç‚ºæ­¢ï¼Œæˆ‘å€‘å·²ç¶“æº–å‚™å¥½äº† Firebase çš„äº‹å‰æº–å‚™ï¼Œæ¥è‘—å°±æº–å‚™é€²å…¥å¯«ç¨‹å¼çš„éƒ¨åˆ†å§ã€‚</p>
<h2 id="Express-Firebase"><a href="#Express-Firebase" class="headerlink" title="Express + Firebase"></a>Express + Firebase</h2><p>æ¥ä¸‹ä¾†å°±æ˜¯å»ºç«‹ Express çš„éƒ¨åˆ†ï¼Œé€™é‚Šæˆ‘æœƒä½¿ç”¨ Express ç”¢ç”Ÿå™¨ä¾†å»ºç«‹ä¸€å€‹æ–°çš„å°ˆæ¡ˆï¼Œå¦‚æœä½ é‚„æ²’æœ‰å®‰è£ Express ç”¢ç”Ÿå™¨ï¼Œå»ºè­°ä½ å¯ä»¥å…ˆå®‰è£ä¸€ä¸‹ï¼Œé€™æ¨£å¯ä»¥è®“ä½ çš„é–‹ç™¼é€Ÿåº¦æ›´å¿«</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm install -g express-generator<br></code></pre></td></tr></table></figure>

<h3 id="å»ºç«‹-Express-å°ˆæ¡ˆ"><a href="#å»ºç«‹-Express-å°ˆæ¡ˆ" class="headerlink" title="å»ºç«‹ Express å°ˆæ¡ˆ"></a>å»ºç«‹ Express å°ˆæ¡ˆ</h3><p>å‰é¢æœ‰æåˆ°æˆ‘å€‘æœƒä½¿ç”¨ Express ç”¢ç”Ÿå™¨ä¾†å»ºç«‹ä¸€å€‹æ–°çš„å°ˆæ¡ˆï¼Œæ‰€ä»¥é€™é‚Šæˆ‘å°±ç›´æ¥æä¾›æˆ‘ä½¿ç”¨çš„æŒ‡ä»¤çµ¦ä½ ï¼Œè®“ä½ å¿«é€Ÿå»ºç«‹</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">express --view=ejs firebase-express<br><br><span class="hljs-built_in">cd</span> firebase-express<br><br>npm install<br></code></pre></td></tr></table></figure>

<h3 id="å»ºç«‹-upload-è³‡æ–™å¤¾"><a href="#å»ºç«‹-upload-è³‡æ–™å¤¾" class="headerlink" title="å»ºç«‹ upload è³‡æ–™å¤¾"></a>å»ºç«‹ upload è³‡æ–™å¤¾</h3><p>æ¥ä¸‹ä¾†è«‹ä½ åœ¨ routes åº•ä¸‹å»ºç«‹ä¸€å€‹ upload.js çš„æª”æ¡ˆï¼Œä¸¦è²¼å…¥ä»¥ä¸‹ç¨‹å¼ç¢¼</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>);<br><span class="hljs-keyword">const</span> router = express.<span class="hljs-title class_">Router</span>();<br><br>router.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/image&#x27;</span>, upload.<span class="hljs-title function_">single</span>(<span class="hljs-string">&#x27;file&#x27;</span>), <span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) &#123;<br>  res.<span class="hljs-title function_">send</span>(&#123;<br>    <span class="hljs-attr">imgUrl</span>: <span class="hljs-string">&#x27;https://israynotarray.com/&#x27;</span><br>  &#125;);<br>&#125;);<br><br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = router;<br></code></pre></td></tr></table></figure>

<p>æ¥è‘—è«‹è¨˜å¾—è¦åœ¨ app.js ä¸­å¼•å…¥é€™å€‹æª”æ¡ˆ</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> uploadRouter = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./routes/upload&#x27;</span>);<br><br><span class="hljs-comment">// ... ç•¥é</span><br><br>app.<span class="hljs-title function_">use</span>(<span class="hljs-string">&#x27;/upload&#x27;</span>, uploadRouter);<br></code></pre></td></tr></table></figure>

<p>ä¸å‡ºæ„å¤–çš„è©±ï¼Œé€™æ™‚å€™ä½ è¼¸å…¥ <code>npm start</code> æ˜¯å¯ä»¥é€é <code>http://localhost:3000/upload/image</code> ä¾†æ¸¬è©¦ä½ çš„ API æ˜¯å¦æ­£å¸¸é‹ä½œçš„ï¼Œè€Œé€™é‚Šæˆ‘æ¨è–¦å¯ä»¥ä½¿ç”¨ <a href="/other/20211207/427026/">Postman</a> ä¾†æ¸¬è©¦ï¼Œå› ç‚ºé€™æ¨£å¯ä»¥è®“ä½ æ›´æ¸…æ¥šçš„çœ‹åˆ°ä½ çš„ API å›å‚³çš„è³‡æ–™ã€‚</p>
<h3 id="å®‰è£ç›¸é—œå¥—ä»¶"><a href="#å®‰è£ç›¸é—œå¥—ä»¶" class="headerlink" title="å®‰è£ç›¸é—œå¥—ä»¶"></a>å®‰è£ç›¸é—œå¥—ä»¶</h3><p>æ¥ä¸‹ä¾†æˆ‘å€‘è¦å®‰è£å¹¾å€‹å¥—ä»¶</p>
<ul>
<li>dotenv<ul>
<li>é€™å€‹å¥—ä»¶å¯ä»¥è®“ä½ åœ¨ç¨‹å¼ä¸­ä½¿ç”¨ç’°å¢ƒè®Šæ•¸</li>
</ul>
</li>
<li>firebase-admin<ul>
<li>é€™å€‹å¥—ä»¶å¯ä»¥è®“ä½ ä½¿ç”¨ Firebase çš„ Admin SDK</li>
</ul>
</li>
<li>multer<ul>
<li>é€™å€‹å¥—ä»¶å¯ä»¥è®“ä½ è™•ç†ä¸Šå‚³æª”æ¡ˆçš„ç›¸é—œäº‹å‹™</li>
</ul>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm install dotenv firebase-admin multer<br></code></pre></td></tr></table></figure>

<blockquote>
<p><strong>Note</strong><br>firebase é™¤äº†æœ‰æä¾› <strong>firebase-admin</strong> å¥—ä»¶ä¹‹å¤–ï¼Œé‚„æœ‰å¦ä¸€å€‹å«åš <strong>firebase</strong> çš„å¥—ä»¶ï¼Œé€™å…©å€‹å¥—ä»¶å¾ˆå¸¸è¢«ææ··ï¼Œå› ç‚ºä¸æ¸…æ¥šç”¨é€”ã€‚<br>é‚£éº¼ï¼Œé€™å…©å€‹å¥—ä»¶çš„å·®åˆ¥æ˜¯ä»€éº¼å‘¢ï¼Ÿ<br><strong>firebase-admin</strong>ï¼šé€™å€‹å¥—ä»¶å¯ä»¥è®“ä½ ä½¿ç”¨ Firebase çš„ Admin SDKï¼Œè€Œé€™å€‹å¥—ä»¶å¯ä»¥è®“ä½ ä½¿ç”¨ Firebase çš„æ‰€æœ‰åŠŸèƒ½ï¼ŒåŒ…å«èªè­‰ã€è³‡æ–™åº«ã€å„²å­˜ç©ºé–“ç­‰ç­‰ã€‚<br><strong>firebase</strong>ï¼šé€™å€‹å¥—ä»¶å¯ä»¥è®“ä½ ä½¿ç”¨ Firebase çš„ Client SDKï¼Œè€Œé€™å€‹å¥—ä»¶åªèƒ½è®“ä½ ä½¿ç”¨ Firebase çš„éƒ¨åˆ†åŠŸèƒ½ï¼Œä¾‹å¦‚ï¼šèªè­‰ã€å„²å­˜ç©ºé–“ç­‰ç­‰ã€‚</p>
</blockquote>
<h3 id="å»ºç«‹-env-æª”æ¡ˆ"><a href="#å»ºç«‹-env-æª”æ¡ˆ" class="headerlink" title="å»ºç«‹ .env æª”æ¡ˆ"></a>å»ºç«‹ .env æª”æ¡ˆ</h3><p>æ¥è‘—è«‹ä½ åœ¨å°ˆæ¡ˆæ ¹ç›®éŒ„ä¸‹å»ºç«‹ä¸€å€‹ <code>.env</code> æª”æ¡ˆï¼Œå…§å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs env">FIREBASE_TYPE=<br>FIREBASE_PROJECT_ID=<br>FIREBASE_PRIVATE_KEY_ID=<br>FIREBASE_PRIVATE_KEY=<br>FIREBASE_CLIENT_EMAIL=<br>FIREBASE_CLIENT_ID=<br>FIREBASE_AUTH_URI=<br>FIREBASE_TOKEN_URI=<br>FIREBASE_AUTH_PROVIDER_X509_CERT_URL=<br>FIREBASE_CLIENT_X509_CERT_URL=<br></code></pre></td></tr></table></figure>

<p>è€Œé€™é‚Šéƒ½æœƒå°æ‡‰åˆ°ä½ åœ¨ã€Œå–å¾— Firebase Admin SDKã€å°ç¯€æ™‚æ‰€å–å¾—çš„ JSON è³‡æ–™ï¼Œè«‹ä½ å°‡å°æ‡‰çš„è³‡æ–™å¡«å…¥ <code>.env</code> æª”æ¡ˆä¸­ã€‚</p>
<blockquote>
<p><strong>Note</strong><br>æ¥å…¥ Env è³‡è¨Šçš„æ™‚å€™ï¼Œä½ å¯ä»¥æŠŠ <code>.env</code> æª”æ¡ˆåŠ å…¥åˆ° <code>.gitignore</code> ä¸­ï¼Œé€™æ¨£å°±å¯ä»¥é¿å…ä½ çš„è³‡è¨Šè¢«å…¶ä»–äººçœ‹åˆ°ã€‚</p>
</blockquote>
<p>æ¥è‘—è«‹ä½ åœ¨å°ˆæ¡ˆæ ¹ç›®éŒ„ä¸‹å»ºç«‹ä¸€å€‹ <code>connection/firebase.js</code> æª”æ¡ˆï¼Œå…§å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;dotenv&#x27;</span>).<span class="hljs-title function_">config</span>();<br><span class="hljs-keyword">const</span> admin = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;firebase-admin&quot;</span>);<br><br><span class="hljs-keyword">const</span> config = &#123;<br>  <span class="hljs-attr">type</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">FIREBASE_TYPE</span>,<br>  <span class="hljs-attr">project_id</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">FIREBASE_PROJECT_ID</span>,<br>  <span class="hljs-attr">private_key_id</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">FIREBASE_PRIVATE_KEY_ID</span>,<br>  <span class="hljs-attr">private_key</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">FIREBASE_PRIVATE_KEY</span>.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\\n/g</span>, <span class="hljs-string">&#x27;\n&#x27;</span>),<br>  <span class="hljs-attr">client_email</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">FIREBASE_CLIENT_EMAIL</span>,<br>  <span class="hljs-attr">client_id</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">FIREBASE_CLIENT_ID</span>,<br>  <span class="hljs-attr">auth_uri</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">FIREBASE_AUTH_URI</span>,<br>  <span class="hljs-attr">token_uri</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">FIREBASE_TOKEN_URI</span>,<br>  <span class="hljs-attr">auth_provider_X509_cert_url</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">FIREBASE_AUTH_PROVIDER_X509_CERT_URL</span>,<br>  <span class="hljs-attr">client_x509_cert_url</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">FIREBASE_CLIENT_X509_CERT_URL</span>,<br>&#125;;<br><br>admin.<span class="hljs-title function_">initializeApp</span>(&#123;<br>  <span class="hljs-attr">credential</span>: admin.<span class="hljs-property">credential</span>.<span class="hljs-title function_">cert</span>(config),<br>&#125;);<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = admin;<br></code></pre></td></tr></table></figure>

<p>æ¥è‘—åªéœ€è¦å›åˆ° <code>routes/upload.js</code> æª”æ¡ˆå¼•å…¥ <code>connection/firebase.js</code> æª”æ¡ˆå³å¯</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> firebaseAdmin = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;../connection/firebase&#x27;</span>);<br><br><span class="hljs-comment">//...ç•¥</span><br></code></pre></td></tr></table></figure>

<p>æ¥ä¸‹ä¾†æˆ‘å€‘æœƒæº–å‚™å¯¦ä½œä¸€ä¸‹ä¸Šå‚³åŠŸèƒ½ï¼Œé‚£éº¼<a target="_blank" rel="noopener" href="https://firebase.google.com/docs/storage/admin/start">å®˜æ–¹æ–‡ä»¶</a>æœ‰æä¾›ä»¥ä¸‹é€™ä¸€æ®µç¨‹å¼ç¢¼</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> &#123; initializeApp, cert &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;firebase-admin/app&#x27;</span>);<br><span class="hljs-keyword">const</span> &#123; getStorage &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;firebase-admin/storage&#x27;</span>);<br><br><span class="hljs-keyword">const</span> serviceAccount = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./path/to/serviceAccountKey.json&#x27;</span>);<br><br><span class="hljs-title function_">initializeApp</span>(&#123;<br>  <span class="hljs-attr">credential</span>: <span class="hljs-title function_">cert</span>(serviceAccount),<br>  <span class="hljs-attr">storageBucket</span>: <span class="hljs-string">&#x27;&lt;BUCKET_NAME&gt;.appspot.com&#x27;</span><br>&#125;);<br><br><span class="hljs-keyword">const</span> bucket = <span class="hljs-title function_">getStorage</span>().<span class="hljs-title function_">bucket</span>();<br></code></pre></td></tr></table></figure>

<p>é‚£éº¼ä½ æœƒç™¼ç¾é€™é‚Šæœ‰ä¸€å€‹ <code>&lt;BUCKET_NAME&gt;.appspot.com</code>ï¼Œ<code>&lt;BUCKET_NAME&gt;</code> å…¶å¯¦å°±æ˜¯ä½ åœ¨ Firebase å»ºç«‹å°ˆæ¡ˆæ™‚æ‰€å–å¾—çš„å°ˆæ¡ˆåç¨±ï¼Œè€Œ <code>.appspot.com</code> å‰‡æ˜¯å›ºå®šçš„ï¼Œå¦‚æœä½ æ‰¾ä¸åˆ°ä½ ä¹Ÿå¯ä»¥çœ‹çœ‹ä½ çš„ Firebase å°ˆæ¡ˆçš„ç¶²å€ï¼Œä¾‹å¦‚ï¼š<code>https://&lt;BUCKET_NAME&gt;.firebaseapp.com</code>ï¼Œé‚£éº¼ <code>&lt;BUCKET_NAME&gt;</code> å°±æ˜¯ä½ çš„å°ˆæ¡ˆåç¨±</p>
<p><img src="https://firebasestorage.googleapis.com/v0/b/welcomewebworld-4097b.appspot.com/o/blogImg%2Ffirebase%2Ffirebase-express%2F%E6%88%AA%E5%9C%96%202022-12-24%2017.05.53.png?alt=media&token=446ba542-3307-47dd-8fa6-eff16a843ae8" alt="BUCKET_NAME"></p>
<p>è€Œå‰›å¥½ <code>BUCKET_NAME</code> å°±æ˜¯æˆ‘å€‘ <code>.env</code> ä¸­çš„ <code>FIREBASE_PROJECT_ID</code>ï¼Œæ‰€ä»¥æˆ‘å€‘å¯ä»¥æŠŠ <code>FIREBASE_PROJECT_ID</code> çš„å€¼å¡«å…¥ <code>storageBucket</code>ï¼Œæ‰€ä»¥é€™é‚Šæ‰“é–‹ <code>connection/firebase.js</code> æª”æ¡ˆï¼Œä¿®æ”¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;dotenv&#x27;</span>).<span class="hljs-title function_">config</span>();<br><span class="hljs-keyword">const</span> admin = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;firebase-admin&quot;</span>);<br><br><span class="hljs-keyword">const</span> config = &#123;<br>  <span class="hljs-attr">type</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">FIREBASE_TYPE</span>,<br>  <span class="hljs-attr">project_id</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">FIREBASE_PROJECT_ID</span>,<br>  <span class="hljs-attr">private_key_id</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">FIREBASE_PRIVATE_KEY_ID</span>,<br>  <span class="hljs-attr">private_key</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">FIREBASE_PRIVATE_KEY</span>.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\\n/g</span>, <span class="hljs-string">&#x27;\n&#x27;</span>),<br>  <span class="hljs-attr">client_email</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">FIREBASE_CLIENT_EMAIL</span>,<br>  <span class="hljs-attr">client_id</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">FIREBASE_CLIENT_ID</span>,<br>  <span class="hljs-attr">auth_uri</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">FIREBASE_AUTH_URI</span>,<br>  <span class="hljs-attr">token_uri</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">FIREBASE_TOKEN_URI</span>,<br>  <span class="hljs-attr">auth_provider_X509_cert_url</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">FIREBASE_AUTH_PROVIDER_X509_CERT_URL</span>,<br>  <span class="hljs-attr">client_x509_cert_url</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">FIREBASE_CLIENT_X509_CERT_URL</span>,<br>&#125;;<br><br>admin.<span class="hljs-title function_">initializeApp</span>(&#123;<br>  <span class="hljs-attr">credential</span>: admin.<span class="hljs-property">credential</span>.<span class="hljs-title function_">cert</span>(config),<br>  <span class="hljs-attr">storageBucket</span>: <span class="hljs-string">`<span class="hljs-subst">$&#123;process.env.FIREBASE_PROJECT_ID&#125;</span>.appspot.com`</span>,<br>&#125;);<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = admin;<br></code></pre></td></tr></table></figure>

<p>åˆ°ç›®å‰ç‚ºæ­¢æˆ‘å€‘æ‰å°‡ Firebase åˆå§‹åŒ–å®Œæˆï¼Œæ¥è‘—å°±æº–å‚™ä¾†å¯¦ç¾ä¸Šå‚³åŠŸèƒ½å§ã€‚</p>
<h2 id="å¯¦ä½œä¸Šå‚³åŠŸèƒ½"><a href="#å¯¦ä½œä¸Šå‚³åŠŸèƒ½" class="headerlink" title="å¯¦ä½œä¸Šå‚³åŠŸèƒ½"></a>å¯¦ä½œä¸Šå‚³åŠŸèƒ½</h2><p>æ¥ä¸‹ä¾†æˆ‘å€‘è¦ä¾†å¯¦ä½œä¸Šå‚³åŠŸèƒ½ï¼Œé¦–å…ˆå‰é¢æˆ‘å€‘æœ‰å®‰è£ä¸€å€‹å¥—ä»¶å«åš <code>multer</code>ï¼Œè€Œé€™å€‹å¥—ä»¶å°±æ˜¯å°ˆé–€æ‹¿ä¾†å¹«æˆ‘å€‘è™•ç†æª”æ¡ˆçš„ï¼Œæ‰€ä»¥é€™é‚Šå…ˆåœ¨ <code>routes/upload.js</code> åŠ å…¥ä»¥ä¸‹ç¨‹å¼ç¢¼</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> multer  = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;multer&#x27;</span>);<br><br><span class="hljs-keyword">const</span> upload = <span class="hljs-title function_">multer</span>(&#123;<br>  <span class="hljs-attr">limits</span>: &#123;<br>    <span class="hljs-attr">fileSize</span>: <span class="hljs-number">5</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>,  <span class="hljs-comment">// 5MB</span><br>  &#125;,<br>&#125;);<br></code></pre></td></tr></table></figure>

<p>ä¸Šé¢çš„ç¨‹å¼ç¢¼ä¸­ï¼Œæˆ‘å€‘å°‡æª”æ¡ˆçš„å¤§å°é™åˆ¶å† 5MB ä»¥å…§ã€‚</p>
<p>æ¥è‘—ç”±æ–¼ <code>multer</code> æ˜¯ä¸€å€‹ Middlewareï¼Œæ‰€ä»¥æˆ‘å€‘å¯ä»¥åœ¨ <code>router.post</code> ä¸­åŠ å…¥ <code>upload.single(&#39;file&#39;)</code>ï¼Œé€™é‚Šçš„ <code>file</code> å°±æ˜¯æˆ‘å€‘åœ¨å‰ç«¯ä¸Šå‚³æ™‚æ‰€ä½¿ç”¨çš„ <code>name</code>ï¼Œæ‰€ä»¥é€™é‚Šæˆ‘å€‘å°±å¯ä»¥åœ¨ <code>req.file</code> ä¸­å–å¾—ä¸Šå‚³çš„æª”æ¡ˆè³‡è¨Š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js">router.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/image&#x27;</span>, upload.<span class="hljs-title function_">single</span>(<span class="hljs-string">&#x27;file&#x27;</span>), <span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) &#123;<br>  <span class="hljs-keyword">const</span> file = req.<span class="hljs-property">file</span>;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(file);<br>  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;ä¸Šå‚³æˆåŠŸ&#x27;</span>);<br>&#125;);<br></code></pre></td></tr></table></figure>

<p>æ¥è‘—ä½ ä¸€æ¨£å¯ä»¥å…ˆå˜—è©¦ä½¿ç”¨ Postman æˆ³æˆ³çœ‹ï¼Œçœ‹çœ‹æ˜¯å¦æœ‰æ­£ç¢ºå–å¾—ä¸Šå‚³çš„æª”æ¡ˆè³‡è¨Š</p>
<p><img src="https://firebasestorage.googleapis.com/v0/b/welcomewebworld-4097b.appspot.com/o/blogImg%2Ffirebase%2Ffirebase-express%2F%E6%88%AA%E5%9C%96%202022-12-25%2000.07.31.png?alt=media&token=cedd4800-9208-4907-a51c-b6460e1dc69e" alt="Postman"></p>
<p>æ¥ä¸‹ä¾†æˆ‘ä¸å¾—ä¸èªª Firebase çš„æ–‡ä»¶é—œæ–¼é€™ä¸€å¡Šçš„æè¿°èªªæ˜æ»¿ä¸æ¸…æ¥šçš„ï¼Œæ‰€ä»¥é€™ä¸€æ®µæˆ‘èŠ±äº†ä¸€é»æ™‚é–“çœ‹æ–‡ä»¶ï¼Œå› æ­¤æ¥ä¸‹ä¾†æˆ‘æœƒå€åˆ†ä¸Šå‚³èˆ‡å–å¾—æª”æ¡ˆçš„ç¶²å€ä¾†èªªæ˜ã€‚</p>
<h3 id="ä¸Šå‚³æª”æ¡ˆ"><a href="#ä¸Šå‚³æª”æ¡ˆ" class="headerlink" title="ä¸Šå‚³æª”æ¡ˆ"></a>ä¸Šå‚³æª”æ¡ˆ</h3><p>é¦–å…ˆæˆ‘å€‘è¦å…ˆå»ºç«‹ Storage çš„ Bucket(å„²å­˜æ¡¶)ï¼Œæ‰€ä»¥é€™é‚Šæˆ‘å€‘è¦åœ¨ <code>routes/upload.js</code> ä¸­åŠ å…¥ä»¥ä¸‹ç¨‹å¼ç¢¼</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> bucket = firebaseAdmin.<span class="hljs-title function_">storage</span>().<span class="hljs-title function_">bucket</span>();<br></code></pre></td></tr></table></figure>

<p>æ¥è‘—æˆ‘å€‘è¦å°‡ä¸Šå‚³çš„æª”æ¡ˆå­˜åˆ° Storage ä¸­ï¼Œæ‰€ä»¥æˆ‘å€‘é€™é‚Šè¦å°‡è·¯ç”±ä¿®æ”¹æˆä»¥ä¸‹ï¼Œåº•ä¸‹æˆ‘æœƒç›¡å¯æ­é…è¨»è§£èªªæ˜</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs js">router.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/image&#x27;</span>, upload.<span class="hljs-title function_">single</span>(<span class="hljs-string">&#x27;file&#x27;</span>), <span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) &#123;<br>  <span class="hljs-comment">// å–å¾—ä¸Šå‚³çš„æª”æ¡ˆè³‡è¨Š</span><br>  <span class="hljs-keyword">const</span> file = req.<span class="hljs-property">file</span>;<br>  <span class="hljs-comment">// åŸºæ–¼æª”æ¡ˆçš„åŸå§‹åç¨±å»ºç«‹ä¸€å€‹ blob ç‰©ä»¶</span><br>  <span class="hljs-keyword">const</span> blob = bucket.<span class="hljs-title function_">file</span>(file.<span class="hljs-property">originalname</span>);<br>  <span class="hljs-comment">// å»ºç«‹ä¸€å€‹å¯ä»¥å¯«å…¥ blob çš„ç‰©ä»¶</span><br>  <span class="hljs-keyword">const</span> blobStream = blob.<span class="hljs-title function_">createWriteStream</span>()<br><br>  <span class="hljs-comment">// ç›£è½ä¸Šå‚³ç‹€æ…‹ï¼Œç•¶ä¸Šå‚³å®Œæˆæ™‚ï¼Œæœƒè§¸ç™¼ finish äº‹ä»¶</span><br>  blobStream.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;finish&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>    res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;ä¸Šå‚³æˆåŠŸ&#x27;</span>);<br>  &#125;);<br><br>  <span class="hljs-comment">// å¦‚æœä¸Šå‚³éç¨‹ä¸­ç™¼ç”ŸéŒ¯èª¤ï¼Œæœƒè§¸ç™¼ error äº‹ä»¶</span><br>  blobStream.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;error&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;<br>    res.<span class="hljs-title function_">status</span>(<span class="hljs-number">500</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;ä¸Šå‚³å¤±æ•—&#x27;</span>);<br>  &#125;);<br><br>  <span class="hljs-comment">// å°‡æª”æ¡ˆçš„ buffer å¯«å…¥ blobStream</span><br>  blobStream.<span class="hljs-title function_">end</span>(file.<span class="hljs-property">buffer</span>);<br>&#125;);<br></code></pre></td></tr></table></figure>

<p>é€™æ™‚å€™ä½ åœ¨å˜—è©¦ä½¿ç”¨ Postman ä¸Šå‚³æª”æ¡ˆï¼Œä¸Šå‚³æˆåŠŸå¾Œï¼Œä½ æ‡‰è©²å¯ä»¥åœ¨ Firebase çš„ Storage ä¸­çœ‹åˆ°ä½ ä¸Šå‚³çš„æª”æ¡ˆã€‚</p>
<p><img src="https://firebasestorage.googleapis.com/v0/b/welcomewebworld-4097b.appspot.com/o/blogImg%2Ffirebase%2Ffirebase-express%2F%E6%88%AA%E5%9C%96%202022-12-25%2000.29.57.png?alt=media&token=4300e2cb-b2fb-49b2-89c7-e67556e4013b" alt="ä¸Šå‚³æª”æ¡ˆ"></p>
<h3 id="å–å¾—æª”æ¡ˆç¶²å€"><a href="#å–å¾—æª”æ¡ˆç¶²å€" class="headerlink" title="å–å¾—æª”æ¡ˆç¶²å€"></a>å–å¾—æª”æ¡ˆç¶²å€</h3><p>é›–ç„¶æˆ‘å€‘å·²ç¶“å°‡æª”æ¡ˆä¸Šå‚³äº†ï¼Œä½†æ˜¯å»æ²’æœ‰å›å‚³æª”æ¡ˆçš„ç¶²å€ï¼Œæ‰€ä»¥é€™é‚Šæˆ‘å€‘è¦åœ¨ä¸Šå‚³æˆåŠŸå¾Œï¼Œå›å‚³æª”æ¡ˆçš„ç¶²å€ï¼Œé€™é‚Šæˆ‘å€‘è¦ä¿®æ”¹ä¸Šé¢çš„ç¨‹å¼ç¢¼ï¼Œè®“ä¸Šå‚³æˆåŠŸå¾Œï¼Œå›å‚³æª”æ¡ˆçš„ç¶²å€</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs js">router.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/image&#x27;</span>, upload.<span class="hljs-title function_">single</span>(<span class="hljs-string">&#x27;file&#x27;</span>), <span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) &#123;<br>  <span class="hljs-keyword">const</span> file = req.<span class="hljs-property">file</span>;<br>  <span class="hljs-keyword">const</span> blob = bucket.<span class="hljs-title function_">file</span>(file.<span class="hljs-property">originalname</span>);<br>  <span class="hljs-keyword">const</span> blobStream = blob.<span class="hljs-title function_">createWriteStream</span>()<br><br>  blobStream.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;finish&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-comment">// è¨­å®šæª”æ¡ˆçš„å­˜å–æ¬Šé™</span><br>    <span class="hljs-keyword">const</span> config = &#123;<br>      <span class="hljs-attr">action</span>: <span class="hljs-string">&#x27;read&#x27;</span>, <span class="hljs-comment">// æ¬Šé™</span><br>      <span class="hljs-attr">expires</span>: <span class="hljs-string">&#x27;12-31-2500&#x27;</span>, <span class="hljs-comment">// ç¶²å€çš„æœ‰æ•ˆæœŸé™</span><br>    &#125;;<br>    <span class="hljs-comment">// å–å¾—æª”æ¡ˆçš„ç¶²å€</span><br>    blob.<span class="hljs-title function_">getSignedUrl</span>(config, <span class="hljs-function">(<span class="hljs-params">err, imgUrl</span>) =&gt;</span> &#123;<br>      res.<span class="hljs-title function_">send</span>(&#123;<br>        imgUrl<br>      &#125;);<br>    &#125;);<br>  &#125;);<br><br>  blobStream.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;error&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;<br>    res.<span class="hljs-title function_">status</span>(<span class="hljs-number">500</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;ä¸Šå‚³å¤±æ•—&#x27;</span>);<br>  &#125;);<br><br>  blobStream.<span class="hljs-title function_">end</span>(file.<span class="hljs-property">buffer</span>);<br>&#125;);<br></code></pre></td></tr></table></figure>

<p>ç”±æ–¼å–å¾—æª”æ¡ˆçš„ç¶²å€éœ€è¦è¨­å®šæª”æ¡ˆçš„å­˜å–æ¬Šé™èˆ‡æœ‰æ•ˆæœŸé™ï¼Œå› æ­¤æˆ‘åˆ»æ„å¯«æˆ 2500 å¹´ï¼Œå…¶å¯¦é€™æ¨£å­ä¹Ÿç­‰åŒæ–¼æ°¸ä¹…ï¼Œè€Œä¸” <code>expires</code> é€™å€‹å±¬æ€§æ˜¯å¿…å¡«çš„ï¼Œä¸ç„¶æœƒå‡ºç¾ <code>Error: The expiration date provided was invalid.</code> çš„éŒ¯èª¤ã€‚</p>
<p>é€™æ™‚å€™ä½ å†æ¬¡ä½¿ç”¨ Postman ä¸Šå‚³æª”æ¡ˆï¼Œä¸Šå‚³æˆåŠŸå¾Œï¼Œä½ æ‡‰è©²å¯ä»¥åœ¨å›å‚³çš„è³‡æ–™ä¸­çœ‹åˆ°æª”æ¡ˆçš„ç¶²å€ã€‚</p>
<blockquote>
<p><strong>Note</strong><br>Firebase çš„ Storage å…¶å¯¦æ˜¯ä½¿ç”¨äº† Google Cloud Storage ä¾†å¯¦ä½œï¼Œæ‰€ä»¥ä½ æœƒç™¼ç¾åœ¨ Firebase ä¸­çš„<a target="_blank" rel="noopener" href="https://firebase.google.com/docs/storage/admin/start">ç®¡ç†è€…</a>å€å¡Šåªæœ‰æåˆ°é–‹å§‹ä½¿ç”¨ï¼Œè€Œæ²’æœ‰æåˆ°å¦‚ä½•ä¸Šå‚³æª”æ¡ˆï¼Œå› ç‚ºé€™éƒ¨åˆ†æ˜¯ç”± Google Cloud Storage ä¾†å¯¦ä½œçš„ï¼Œå› æ­¤ Firebase çš„æ–‡ä»¶æ‰æœƒæœ‰é€™ä¸€å¥è©±</p>
</blockquote>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs txt">You can use the bucket references returned by the Admin SDK in conjunction with the official Google Cloud Storage client libraries to upload, download, and modify content in the buckets associated with your Firebase projects. Note that you do not have to authenticate Google Cloud Storage libraries when using the Firebase Admin SDK. The bucket references returned by the Admin SDK are already authenticated with the credentials used to initialize your Firebase app.<br></code></pre></td></tr></table></figure>

<h3 id="åˆªé™¤æª”æ¡ˆ"><a href="#åˆªé™¤æª”æ¡ˆ" class="headerlink" title="åˆªé™¤æª”æ¡ˆ"></a>åˆªé™¤æª”æ¡ˆ</h3><p>é€™é‚Šä¹Ÿé †ä¾¿è£œå……ä¸€ä¸‹å¦‚ä½•åˆªé™¤ä¸Šå‚³çš„æª”æ¡ˆç¨‹å¼ç¢¼ï¼Œé€™é‚Šæˆ‘ä¹Ÿæœƒè£œä¸Šè¨»è§£</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js">router.<span class="hljs-title function_">delete</span>(<span class="hljs-string">&#x27;/image&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) &#123;<br>  <span class="hljs-comment">// å–å¾—æª”æ¡ˆåç¨±</span><br>  <span class="hljs-keyword">const</span> fileName = req.<span class="hljs-property">query</span>.<span class="hljs-property">fileName</span>;<br>  <span class="hljs-comment">// å–å¾—æª”æ¡ˆ</span><br>  <span class="hljs-keyword">const</span> blob = bucket.<span class="hljs-title function_">file</span>(fileName);<br>  <span class="hljs-comment">// åˆªé™¤æª”æ¡ˆ</span><br>  blob.<span class="hljs-title function_">delete</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>    res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;åˆªé™¤æˆåŠŸ&#x27;</span>);<br>  &#125;).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;<br>    res.<span class="hljs-title function_">status</span>(<span class="hljs-number">500</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;åˆªé™¤å¤±æ•—&#x27;</span>);<br>  &#125;);<br>&#125;);<br></code></pre></td></tr></table></figure>

<blockquote>
<p><strong>Note</strong><br>å¦‚æœåœ–ç‰‡æ˜¯æ”¾åœ¨è³‡æ–™å¤¾åº•ä¸‹çš„è©±ï¼Œé‚£éº¼å°±è¦åŒ…å«è³‡æ–™å¤¾ä¸€èµ·å‚³çµ¦å¾Œç«¯ï¼Œä¾‹å¦‚ <code>images/æˆªåœ– 2022-12-24 17.05.53.png</code>ï¼Œé€™æ¨£å­æ‰èƒ½æ­£ç¢ºçš„åˆªé™¤æª”æ¡ˆã€‚</p>
</blockquote>
<h3 id="å–å¾—æª”æ¡ˆåç¨±åˆ—è¡¨"><a href="#å–å¾—æª”æ¡ˆåç¨±åˆ—è¡¨" class="headerlink" title="å–å¾—æª”æ¡ˆåç¨±åˆ—è¡¨"></a>å–å¾—æª”æ¡ˆåç¨±åˆ—è¡¨</h3><p>ç•¶ç„¶æˆ‘ä¹Ÿæœƒè£œä¸Šå–å¾—æª”æ¡ˆåç¨±åˆ—è¡¨çš„ç¨‹å¼ç¢¼</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js">router.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/image&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) &#123;<br>  <span class="hljs-comment">// å–å¾—æª”æ¡ˆåˆ—è¡¨</span><br>  bucket.<span class="hljs-title function_">getFiles</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">const</span> files = data[<span class="hljs-number">0</span>];<br>    <span class="hljs-keyword">const</span> fileList = [];<br>    files.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">file</span>) =&gt;</span> &#123;<br>      fileList.<span class="hljs-title function_">push</span>(file.<span class="hljs-property">name</span>);<br>    &#125;);<br>    res.<span class="hljs-title function_">send</span>(fileList);<br>  &#125;)<br>  .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;<br>    res.<span class="hljs-title function_">status</span>(<span class="hljs-number">500</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;å–å¾—æª”æ¡ˆåˆ—è¡¨å¤±æ•—&#x27;</span>);<br>  &#125;);<br>&#125;);<br></code></pre></td></tr></table></figure>

<p>å¦‚æœæ˜¯æƒ³è¦åŒ…å«é€£çµçš„è©±ï¼Œå‰‡æ”¹æˆä»¥ä¸‹</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs js">router.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/image&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) &#123;<br>  <span class="hljs-comment">// å–å¾—æª”æ¡ˆåˆ—è¡¨</span><br>  bucket.<span class="hljs-title function_">getFiles</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> &#123;<br>    <br>    <span class="hljs-keyword">return</span> data[<span class="hljs-number">0</span>]<br>  &#125;).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">files</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">const</span> fileList = [];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> file <span class="hljs-keyword">of</span> files) &#123;<br>      <span class="hljs-comment">// å–å¾—æª”æ¡ˆçš„ç°½ç½² URL</span><br>      <span class="hljs-keyword">const</span> fileUrl = <span class="hljs-keyword">await</span> file.<span class="hljs-title function_">getSignedUrl</span>(&#123;<br>        <span class="hljs-attr">action</span>: <span class="hljs-string">&#x27;read&#x27;</span>,<br>        <span class="hljs-attr">expires</span>: <span class="hljs-string">&#x27;03-09-2491&#x27;</span><br>      &#125;);<br>      fileList.<span class="hljs-title function_">push</span>(&#123;<br>        <span class="hljs-attr">fileName</span>: file.<span class="hljs-property">name</span>,<br>        <span class="hljs-attr">imgUrl</span>: fileUrl<br>      &#125;);<br>    &#125;<br>    res.<span class="hljs-title function_">send</span>(fileList);<br>  &#125;).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;<br>    res.<span class="hljs-title function_">status</span>(<span class="hljs-number">500</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;å–å¾—æª”æ¡ˆåˆ—è¡¨å¤±æ•—&#x27;</span>);<br>  &#125;);<br>&#125;);<br></code></pre></td></tr></table></figure>

<p>é€™æ¨£å°±å¯ä»¥å–å¾—æª”æ¡ˆåç¨±å’Œé€£çµäº†ã€‚</p>
<p><img src="https://firebasestorage.googleapis.com/v0/b/welcomewebworld-4097b.appspot.com/o/blogImg%2Ffirebase%2Ffirebase-express%2F%E6%88%AA%E5%9C%96%202022-12-25%2014.41.00.png?alt=media&token=a24719fb-b21a-44cc-bfda-2b1166117fd0" alt="æª”æ¡ˆåç¨±èˆ‡é€£çµ"></p>
<h3 id="æŒ‡å®šä¸Šå‚³æª”æ¡ˆåˆ°ç‰¹å®šè³‡æ–™å¤¾"><a href="#æŒ‡å®šä¸Šå‚³æª”æ¡ˆåˆ°ç‰¹å®šè³‡æ–™å¤¾" class="headerlink" title="æŒ‡å®šä¸Šå‚³æª”æ¡ˆåˆ°ç‰¹å®šè³‡æ–™å¤¾"></a>æŒ‡å®šä¸Šå‚³æª”æ¡ˆåˆ°ç‰¹å®šè³‡æ–™å¤¾</h3><p>å…¶å¯¦æˆ‘å€‘ä¸Šå‚³åœ–ç‰‡çš„æ™‚å€™ï¼Œéƒ½æœƒå¸Œæœ›å¯ä»¥åˆ†é¡ï¼Œä½†å…¶å¯¦é€™ä¸€æ®µæ˜¯éå¸¸ç°¡å–®çš„ï¼Œåªéœ€è¦åœ¨å‰é¢çš„ç¨‹å¼ç¢¼ä¸­ï¼Œå°‡ <code>bucket.file(file.originalname)</code> æ”¹æˆ <code>bucket.file(&#39;images/&#39; + file.originalname)</code>ï¼Œé€™æ¨£ä¸Šå‚³çš„æª”æ¡ˆå°±æœƒè¢«æ”¾åˆ° <code>images</code> è³‡æ–™å¤¾ä¸­ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs js">router.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/image&#x27;</span>, upload.<span class="hljs-title function_">single</span>(<span class="hljs-string">&#x27;file&#x27;</span>), <span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) &#123;<br>  <span class="hljs-keyword">const</span> file = req.<span class="hljs-property">file</span>;<br>  <span class="hljs-comment">// æŒ‡å®šä¸Šå‚³çš„è³‡æ–™å¤¾</span><br>  <span class="hljs-keyword">const</span> blob = bucket.<span class="hljs-title function_">file</span>(<span class="hljs-string">`images/<span class="hljs-subst">$&#123;file.originalname&#125;</span>`</span>);<br>  <span class="hljs-keyword">const</span> blobStream = blob.<span class="hljs-title function_">createWriteStream</span>()<br><br>  blobStream.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;finish&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>    res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;ä¸Šå‚³æˆåŠŸ&#x27;</span>);<br>  &#125;);<br><br>  blobStream.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;error&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;<br>    res.<span class="hljs-title function_">status</span>(<span class="hljs-number">500</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;ä¸Šå‚³å¤±æ•—&#x27;</span>);<br>  &#125;);<br><br>  blobStream.<span class="hljs-title function_">end</span>(file.<span class="hljs-property">buffer</span>);<br>&#125;);<br></code></pre></td></tr></table></figure>

<blockquote>
<p><strong>Note</strong><br>å¦‚æœè³‡æ–™ä¸å­˜åœ¨çš„è©±ï¼ŒFirebase æœƒè‡ªå‹•å¹«ä½ å»ºç«‹è³‡æ–™å¤¾å”·ï¼</p>
</blockquote>
<h2 id="ä¸­é€”å°çµ"><a href="#ä¸­é€”å°çµ" class="headerlink" title="ä¸­é€”å°çµ"></a>ä¸­é€”å°çµ</h2><p>å‰é¢æˆ‘å€‘åˆ†åˆ¥å­¸ç¿’äº†ä¸Šå‚³ã€å–å¾—æª”æ¡ˆé€£çµã€åˆªé™¤æª”æ¡ˆã€æª”æ¡ˆåˆ—è¡¨ç­‰èªæ³•ï¼Œé€™äº›éƒ½å¯ä»¥èªªæ˜¯æˆ‘å€‘ä¸Šå‚³æª”æ¡ˆçš„åŸºç¤ï¼Œä½†é€™ä¸€æ®µå…¶å¯¦æˆ‘å€‘ç¼ºå°‘äº†ä¸€äº›åœ°æ–¹ï¼Œä¾‹å¦‚ä¸Šå‚³æª”æ¡ˆå¾Œæ‡‰é‡æ–°å‘½åé¿å…æª”åé‡è¤‡ä»¥åŠå…ˆå£“ç¸®åœ–ç‰‡å¾Œå†ä¸Šå‚³åˆ° Firebaseï¼Œæ‰€ä»¥å¾Œé¢å°±è®“æˆ‘å€‘æ¥è‘—è£œå……é€™äº›å§ã€‚</p>
<h2 id="åŠ ç¢¼è£œå……"><a href="#åŠ ç¢¼è£œå……" class="headerlink" title="åŠ ç¢¼è£œå……"></a>åŠ ç¢¼è£œå……</h2><p>æ¥è‘—é€™é‚Šæˆ‘é¡å¤–è£œå……ä¸€äº›æˆ‘å€‘ä¸Šå‚³æª”æ¡ˆæ™‚æœƒéœ€è¦çš„åŠŸèƒ½ï¼Œä¾‹å¦‚é‡æ–°å‘½åæª”æ¡ˆã€å£“ç¸®åœ–ç‰‡ç­‰ç­‰é‡é»</p>
<h3 id="é‡æ–°å‘½åæª”æ¡ˆ"><a href="#é‡æ–°å‘½åæª”æ¡ˆ" class="headerlink" title="é‡æ–°å‘½åæª”æ¡ˆ"></a>é‡æ–°å‘½åæª”æ¡ˆ</h3><p>é‡æ–°å‘½åæª”æ¡ˆçš„æ–¹å¼éå¸¸ç°¡å–®ï¼Œé€šå¸¸æª”æ¡ˆåç¨±æœƒæœ‰å¹¾ç¨®æ–¹å¼</p>
<ul>
<li>æ™‚é–“æˆ³è¨˜</li>
<li>uuid</li>
<li>äº‚æ•¸</li>
</ul>
<p>è€Œé€™é‚Šæˆ‘å€‘å°±ä½¿ç”¨ uuid ä¾†é‡æ–°å‘½åæª”æ¡ˆï¼Œé‚£ä»€éº¼æ˜¯ uuid å‘¢ï¼Ÿuuid ä¸­æ–‡åç¨±æ˜¯ã€Œé€šç”¨å”¯ä¸€è¾¨è­˜ç¢¼(Universally Unique Identifier)ã€ï¼Œä¸¦ä¸”å®ƒçš„é‡è¤‡æ©Ÿç‡æ˜¯è¶¨è¿‘æ–¼é›¶ï¼Œæ‰€ä»¥æˆ‘å€‘å¯ä»¥å®‰å¿ƒçš„ä½¿ç”¨å®ƒä¾†é‡æ–°å‘½åæª”æ¡ˆã€‚</p>
<p>åœ¨é‚£ä¹‹å‰ä½ å¿…é ˆå…ˆæ›¿å°ˆæ¡ˆå®‰è£ uuid å¥—ä»¶</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm install uuid<br></code></pre></td></tr></table></figure>

<p>æ¥è‘—å†ä¾†ä¿®æ”¹ä¸Šå‚³æª”æ¡ˆçš„ç¨‹å¼ç¢¼</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> &#123; <span class="hljs-attr">v4</span>: uuidv4 &#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;uuid&#x27;</span>);<br><br><span class="hljs-comment">//...ç•¥é</span><br><br>router.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/image&#x27;</span>, upload.<span class="hljs-title function_">single</span>(<span class="hljs-string">&#x27;file&#x27;</span>), <span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) &#123;<br>  <span class="hljs-keyword">const</span> file = req.<span class="hljs-property">file</span>;<br>  <span class="hljs-comment">// æŒ‡å®šä¸Šå‚³çš„è³‡æ–™å¤¾ä¸¦å°‡æª”æ¡ˆé‡æ–°å‘½åï¼Œè«‹è¨˜å¾—è£œä¸Šå‰¯æª”å</span><br>  <span class="hljs-keyword">const</span> blob = bucket.<span class="hljs-title function_">file</span>(<span class="hljs-string">`images/<span class="hljs-subst">$&#123;uuidv4()&#125;</span>.<span class="hljs-subst">$&#123;file.originalname.split(<span class="hljs-string">&#x27;.&#x27;</span>).pop()&#125;</span>`</span>);<br>  <span class="hljs-keyword">const</span> blobStream = blob.<span class="hljs-title function_">createWriteStream</span>()<br><br>  blobStream.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;finish&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>    res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;ä¸Šå‚³æˆåŠŸ&#x27;</span>);<br>  &#125;);<br><br>  blobStream.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;error&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;<br>    res.<span class="hljs-title function_">status</span>(<span class="hljs-number">500</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;ä¸Šå‚³å¤±æ•—&#x27;</span>);<br>  &#125;);<br><br>  blobStream.<span class="hljs-title function_">end</span>(file.<span class="hljs-property">buffer</span>);<br>&#125;);<br></code></pre></td></tr></table></figure>

<p>é€™æ¨£ä½ çš„æª”æ¡ˆä¸Šå‚³æ™‚ï¼Œå°±æœƒé‡æ–°å‘½åäº†</p>
<p><img src="https://firebasestorage.googleapis.com/v0/b/welcomewebworld-4097b.appspot.com/o/blogImg%2Ffirebase%2Ffirebase-express%2F%E6%88%AA%E5%9C%96%202022-12-25%2014.03.34.png?alt=media&token=607923fa-53e1-4267-a475-6510cfcca4c8" alt="é‡æ–°å‘½å"></p>
<h3 id="å£“ç¸®åœ–ç‰‡-TinyPNG"><a href="#å£“ç¸®åœ–ç‰‡-TinyPNG" class="headerlink" title="å£“ç¸®åœ–ç‰‡(TinyPNG)"></a>å£“ç¸®åœ–ç‰‡(TinyPNG)</h3><p>æ¥è‘—æˆ‘å€‘è¦ä¾†å£“ç¸®åœ–ç‰‡ï¼Œå£“ç¸®åœ–ç‰‡çš„æ–¹å¼æ»¿å¤šç¨®çš„ï¼Œä½†æ˜¯é€™é‚Šæˆ‘å€‘å°‡æœƒä½¿ç”¨ TinyPNG ä¾†å£“ç¸®åœ–ç‰‡ï¼Œè€Œ TinyPNG æ˜¯ä¸€å€‹åœ–ç‰‡å£“ç¸®æœå‹™ï¼Œå®ƒå¯ä»¥å°‡åœ–ç‰‡å£“ç¸®åˆ°åŸæœ¬çš„ 1&#x2F;3ï¼Œè€Œä¸”å®ƒçš„å£“ç¸®å“è³ªä¹Ÿä¸æœƒæœ‰å¤ªå¤§çš„å·®ç•°ï¼Œæ‰€ä»¥æˆ‘å€‘å¯ä»¥å®‰å¿ƒçš„ä½¿ç”¨å®ƒä¾†å£“ç¸®åœ–ç‰‡ã€‚</p>
<blockquote>
<p><strong>Note</strong><br>å…è²»ç‰ˆçš„ TinyPNG æœ‰ä¸€å€‹é™åˆ¶è¦ç¨å¾®æ³¨æ„ä¸€ä¸‹ï¼Œå°±æ˜¯æ¯å€‹æœˆåªèƒ½å£“ç¸® 500 å¼µåœ–ç‰‡ã€‚</p>
</blockquote>
<p>ä¸€é–‹å§‹ä½ å¿…é ˆå…ˆç”³è«‹ä¸€å€‹ TinyPNG çš„å¸³è™Ÿï¼Œè«‹ä½ å…ˆåˆ°<a target="_blank" rel="noopener" href="https://tinypng.com/developers">é€™å€‹</a>é é¢ç”³è«‹</p>
<p><img src="https://firebasestorage.googleapis.com/v0/b/welcomewebworld-4097b.appspot.com/o/blogImg%2Ffirebase%2Ffirebase-express%2F%E6%88%AA%E5%9C%96%202022-12-25%2016.09.33.png?alt=media&token=19f91bdb-137a-4a34-9736-c7c2bab941a3" alt="TinyPNG"></p>
<p>æ¥è‘—ä½ å°±æœƒæ”¶åˆ°ä¸€å°ä¿¡ï¼Œè£¡é¢æœƒæœ‰é€²å…¥ TinyPNG çš„ç¶²å€</p>
<p><img src="https://firebasestorage.googleapis.com/v0/b/welcomewebworld-4097b.appspot.com/o/blogImg%2Ffirebase%2Ffirebase-express%2F%E6%88%AA%E5%9C%96%202022-12-25%2016.11.51.png?alt=media&token=c60bbd76-c8af-4a03-b042-d3e95743863c" alt="ä¿¡ä»¶"></p>
<p>é»æ“Šå¾Œï¼ŒåŸºæœ¬ä¸Šä½ å°±å¯ä»¥åˆ°é” TinyPNG çš„å¾Œå°ï¼Œè£¡é¢æœƒæœ‰ä¸€çµ„ API Key å…ˆå°‡å®ƒè¤‡è£½ä¸‹ä¾†</p>
<p><img src="https://firebasestorage.googleapis.com/v0/b/welcomewebworld-4097b.appspot.com/o/blogImg%2Ffirebase%2Ffirebase-express%2F202212251613.jpg?alt=media&token=83fe1598-75f4-4828-adec-98c35eec236e" alt="API Key"></p>
<p>æ¥è‘—å°±æ˜¯å®‰è£ TinyPNG çš„å¥—ä»¶</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm install tinify<br></code></pre></td></tr></table></figure>

<p>ä¸¦å°‡ API Key è¨­å®šåˆ°ç’°å¢ƒè®Šæ•¸</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">TINYPNG_API_KEY=<br></code></pre></td></tr></table></figure>

<p>æ¥ä¸‹ä¾†å°±æ˜¯ä¿®æ”¹ä¸Šå‚³æª”æ¡ˆçš„ç¨‹å¼ç¢¼å°±å¯ä»¥å›‰~</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> tinify = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;tinify&quot;</span>);<br>tinify.<span class="hljs-property">key</span> = process.<span class="hljs-property">env</span>.<span class="hljs-property">TINYPNG_API_KEY</span>;<br><br><span class="hljs-comment">//...ç•¥é</span><br><br>router.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/image&#x27;</span>, upload.<span class="hljs-title function_">single</span>(<span class="hljs-string">&#x27;file&#x27;</span>), <span class="hljs-keyword">function</span> (<span class="hljs-params">req, res</span>) &#123;<br>  <span class="hljs-keyword">const</span> file = req.<span class="hljs-property">file</span>;<br><br>  <span class="hljs-comment">// ä¸Šå‚³åœ–ç‰‡åˆ° TinyPNG ä¸¦å£“ç¸®</span><br>  tinify.<span class="hljs-title function_">fromBuffer</span>(file.<span class="hljs-property">buffer</span>).<span class="hljs-title function_">toBuffer</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">err, resultData</span>) &#123;<br>    <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">throw</span> err;<br><br>    <span class="hljs-keyword">const</span> blob = bucket.<span class="hljs-title function_">file</span>(<span class="hljs-string">`images/<span class="hljs-subst">$&#123;uuidv4()&#125;</span>.<span class="hljs-subst">$&#123;file.originalname.split(<span class="hljs-string">&#x27;.&#x27;</span>).pop()&#125;</span>`</span>);<br>    <span class="hljs-keyword">const</span> blobStream = blob.<span class="hljs-title function_">createWriteStream</span>()<br><br>    blobStream.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;finish&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>      res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;ä¸Šå‚³æˆåŠŸ&#x27;</span>);<br>    &#125;);<br><br>    blobStream.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;error&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> &#123;<br>      res.<span class="hljs-title function_">status</span>(<span class="hljs-number">500</span>).<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;ä¸Šå‚³å¤±æ•—&#x27;</span>);<br>    &#125;);<br><br>    <span class="hljs-comment">// å°‡å£“ç¸®å¾Œçš„åœ–ç‰‡ä¸Šå‚³åˆ° Firebase Storage</span><br>    blobStream.<span class="hljs-title function_">end</span>(resultData);<br>  &#125;);<br>&#125;);<br></code></pre></td></tr></table></figure>

<p>æ¥è‘—ä½ å†å»çœ‹çœ‹ä½ çš„ Firebase Storageï¼Œä½ æœƒç™¼ç¾ä½ çš„åœ–ç‰‡å·²ç¶“è¢«å£“ç¸®ï¼Œåº•ä¸‹é€™å…©å€‹éƒ½æ˜¯ç›¸åŒçš„åœ–ç‰‡ï¼Œä¸€å€‹æ˜¯æœªå£“ç¸® 21.47kbï¼Œå¦ä¸€å€‹æ˜¯è¢«å£“ç¸®å¾Œ 6.78kb</p>
<p><img src="https://firebasestorage.googleapis.com/v0/b/welcomewebworld-4097b.appspot.com/o/blogImg%2Ffirebase%2Ffirebase-express%2F%E6%88%AA%E5%9C%96%202022-12-25%2016.23.12.png?alt=media&token=68f84506-dadb-4f57-bad7-f9fa4d31f837" alt="å£“ç¸®å‰å¾Œ"></p>
<blockquote>
<p><strong>Note</strong><br>TinyPNG é™¤äº†å¯ä»¥å£“ç¸®åœ–ç‰‡ä¹‹å¤–ï¼Œä¹Ÿå¯ä»¥èª¿æ•´åœ–ç‰‡å¤§å°ï¼Œè©³ç´°å¯ä»¥åƒè€ƒ<a target="_blank" rel="noopener" href="https://tinypng.com/developers/reference/nodejs">å®˜æ–¹æ–‡ä»¶</a>ã€‚<br>ç•¶ç„¶é™¤äº†è€ç‰Œçš„ TinyPNG ä¹‹å¤–ï¼Œä¹Ÿæœ‰ <a target="_blank" rel="noopener" href="https://kraken.io/docs/getting-started">Kraken.io</a> å¯ä»¥ä½¿ç”¨å”·ã€‚</p>
</blockquote>
<h2 id="çµè«–"><a href="#çµè«–" class="headerlink" title="çµè«–"></a>çµè«–</h2><p>é€™ä¸€ç¯‡ç¨å¾®æ¯”è¼ƒé•·ä¸€é»ï¼Œä½†æ˜¯æˆ‘æƒ³æ‡‰è©²æ˜¯æ»¿è©³ç´°çš„äº†ï¼Œç•¢ç«Ÿ Firebase Storage é€™ä¸€å¡Šæˆ‘ç™¼ç¾åœ¨ä¸²æ¥ä¸ŠçœŸçš„æ»¿è¤‡é›œçš„ï¼Œæ‰€ä»¥å°±ä¹¾è„†æŠŠæ•´å€‹æµç¨‹éƒ½çµ¦å®ƒè¨˜éŒ„ä¸‹ä¾†ï¼Œå¦‚æœä½ æƒ³è¦é€™ä»½ç¯„ä¾‹ç¨‹å¼ç¢¼çš„è©±ï¼Œæˆ‘ä¹Ÿæ”¾åœ¨ GitHub ä¸Šå›‰~</p>
<p><a target="_blank" rel="noopener" href="https://github.com/hsiangfeng/firebase-storage-example">GitHub</a></p>
<h2 id="åƒè€ƒæ–‡ç»"><a href="#åƒè€ƒæ–‡ç»" class="headerlink" title="åƒè€ƒæ–‡ç»"></a>åƒè€ƒæ–‡ç»</h2><ul>
<li><a target="_blank" rel="noopener" href="https://cloud.google.com/appengine/docs/flexible/using-cloud-storage?hl=zh-tw&tab=node.js#application_code">Application code</a></li>
<li><a target="_blank" rel="noopener" href="https://gist.github.com/stardustxx/58748550699228174b805aaadfc98a35">NodeJS Firebase Storage Sample</a></li>
<li><a target="_blank" rel="noopener" href="https://firebase.google.com/docs/reference/admin/node/firebase-admin.storage.storage">Firebase API reference Bucket</a></li>
<li><a target="_blank" rel="noopener" href="https://firebase.google.com/docs/storage/admin/start">Admin Cloud Storage API</a></li>
<li><a target="_blank" rel="noopener" href="https://kraken.io/docs/getting-started">Kraken API Reference</a></li>
<li><a target="_blank" rel="noopener" href="https://tinypng.com/developers/reference/nodejs">TinyPNG API Reference</a></li>
</ul>

    </div>

    <!-- Post Footer Ad Slot -->
    
      <div class="mt-12 w-full min-h-[300px] bg-gray-50 dark:bg-gray-900 p-4 text-center rounded-lg border border-gray-100 dark:border-gray-700 overflow-hidden relative">
        <!-- Fallback Text (Visible when AdBlock is on) -->
        <div class="absolute inset-0 flex items-center justify-center p-4 text-center">
          <p class="text-xs text-gray-400 dark:text-gray-500 leading-relaxed">
            æ•´ç†é€™äº›æŠ€è¡“ç­†è¨˜çœŸçš„å¾ˆèŠ±æ™‚é–“ï¼Œå¦‚æœä½ é¡˜æ„ <strong>é—œé–‰ Adblock</strong> æ”¯æŒæˆ‘ï¼Œæˆ‘æœƒæŠŠé€™ä»½æ„Ÿè¬è½‰æ›æˆæ›´å¤šã€Œè¸©å‘è½‰é¿å‘ã€çš„å…§å®¹çµ¦ä½ ï¼ãƒ½(ãƒ»âˆ€ãƒ»)ï¾‰
          </p>
        </div>
        <!-- Ad Unit (z-index higher than fallback) -->
        <div class="relative z-10 w-full min-h-[280px]">
          <span class="text-xs text-gray-400 uppercase tracking-wider block mb-2">Advertisement</span>
          <!-- ArrayException_Post_Footer -->
          <ins class="adsbygoogle"
               style="display:block;min-width:300px;width:100%;"
               data-ad-client="ca-pub-4319471747130190"
               data-ad-slot="5156296783"
               data-ad-format="auto"
               data-full-width-responsive="true"></ins>
          <script>
               (adsbygoogle = window.adsbygoogle || []).push({});
          </script>
        </div>
      </div>
    
    
    <!-- Article Footer -->
    
  <div class="space-y-8 mt-12">
    
    <!-- Support Section -->
    
      <div class="text-center">
        <h4 class="flex items-center justify-center gap-2 text-lg font-bold text-gray-900 dark:text-white mb-4">
          <i class="bi bi-heart-fill text-red-500"></i>
          ä½ çš„æ”¯æŒæœƒç›´æ¥è½‰æ›æˆæ›´å¤šæŠ€è¡“ç­†è¨˜
        </h4>
        <div class="border-2 border-dashed border-gray-300 dark:border-gray-700 rounded-xl p-6 bg-gray-50 dark:bg-gray-900/50">
          <p class="text-sm text-gray-600 dark:text-gray-400 mb-6 leading-relaxed">
            å¦‚æœæˆ‘çš„ç­†è¨˜è®“ä½ å°‘è¸©ä¸€å€‹å‘ã€ç¯€çœ Debug çš„æ™‚é–“ï¼Œ<br />ä¹Ÿè¨±ä½ å¯ä»¥è«‹æˆ‘å–æ¯å’–å•¡ï¼Œè®“æˆ‘ç¹¼çºŒç•¶å€‹ä¸æ˜¯ Array çš„ Ray â˜•
          </p>
          <div class="flex flex-wrap justify-center items-center gap-4">
            
            
            
              
              
                <a href="https://www.buymeacoffee.com/israynotarray" target="_blank" class="hover:opacity-90 transition-opacity">
                  <img src="https://cdn.buymeacoffee.com/buttons/v2/default-yellow.png" alt="buymeacoffee" class="no-fancybox h-[50px] w-auto object-contain">
                </a>
                
                  <span class="text-gray-300 dark:text-gray-600">|</span>
                
              
            
              
              
                <a href="https://line.me/S/shop/sticker/author/5311475/top?lang=zh-Hant&amp;utm_source=gnsh_staut" target="_blank" class="hover:opacity-90 transition-opacity">
                  <img src="/images/line-images.png" alt="line" class="no-fancybox h-[50px] w-auto object-contain">
                </a>
                
                  <span class="text-gray-300 dark:text-gray-600">|</span>
                
              
            
              
              
                <a href="https://portaly.cc/israynotarray/support" target="_blank" class="hover:opacity-90 transition-opacity">
                  <img src="/images/logo.b91a6dbf.webp" alt="portaly" class="no-fancybox h-[50px] w-auto object-contain bg-white rounded p-2">
                </a>
                
              
            
          </div>
        </div>
      </div>
    

    <!-- Terminal Section -->
    
      <div class="text-center">
        <h4 class="flex items-center justify-center gap-2 text-lg font-bold text-gray-900 dark:text-white mb-4">
          <i class="bi bi-terminal-fill text-gray-700 dark:text-gray-300"></i>
          Terminal
        </h4>
        
        <!-- Import 8-bit Font -->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">

        <div id="terminal-container" class="w-full max-w-3xl mx-auto bg-[#1a1b26] rounded-xl shadow-[0_20px_50px_rgba(0,0,0,0.5)] overflow-hidden text-left border border-gray-800/50 font-['VT323',monospace] text-xl md:text-2xl tracking-wide hidden">
  <!-- Terminal Header -->
  <div class="bg-[#1a1b26] px-4 py-3 flex items-center gap-2 border-b border-[#1f2335]">
    <div class="flex gap-2">
      <div class="w-3 h-3 rounded-full bg-[#ff5f56] hover:bg-[#ff5f56]/80 transition-colors shadow-sm border border-[#e0443e]"></div>
      <div class="w-3 h-3 rounded-full bg-[#ffbd2e] hover:bg-[#ffbd2e]/80 transition-colors shadow-sm border border-[#dea123]"></div>
      <div class="w-3 h-3 rounded-full bg-[#27c93f] hover:bg-[#27c93f]/80 transition-colors shadow-sm border border-[#1aab29]"></div>
    </div>
    <div class="flex-1 text-center text-gray-400 text-xs font-medium font-sans select-none">ray â€” -zsh â€” 80x24</div>
  </div>
  
  <!-- Terminal Content -->
  <div class="p-6 text-[#a9b1d6] space-y-2 leading-relaxed min-h-[300px] max-h-[500px] overflow-y-auto scrollbar-hide" id="terminal-output">
    <!-- Welcome Message -->
    
      
        <div class="text-[#c0caf5]">Welcome to Ray Terminal v1.0.0</div>
      
        <div class="text-[#c0caf5]">Type &#34;help&#34; to see available commands.</div>
      
        <div class="text-[#c0caf5]">------------------------------------</div>
      
    
    
    <!-- Input Line -->
    <div class="flex flex-wrap gap-2 items-center mt-4">
      <span class="text-[#7aa2f7]">âœ</span>
      <span class="text-[#7dcfff]">~</span>
      <input type="text" 
             id="terminal-input" 
             class="bg-transparent border-none outline-none text-[#c0caf5] flex-1 caret-[#7aa2f7] p-0 font-inherit focus:ring-0" 
             autocomplete="off" 
             spellcheck="false"
             placeholder="Type 'help' for available commands..."
             style="min-width: 200px;">
    </div>
  </div>
</div>

<script>
  // Pass configuration to the Terminal class
  window.terminalConfig = {
    quotes: ["Ray ä¸æ˜¯ Arrayï¼Œä½†æˆ‘å¸¸è¢« push åˆ°æ¥µé™ã€‚","ä»Šå¤©çš„æˆ‘ï¼Œä¸æ˜¯ new Ray()ï¼Œæ˜¯ new Content().","Debug æ˜¯æˆ‘çš„ cardioã€‚","æˆ‘ä¸æ˜¯ Arrayï¼Œä½†äººç”Ÿä¸€ç›´åœ¨ mapã€filterã€reduceã€‚","Bug ä¸æ˜¯å•é¡Œï¼Œæ‰¾åˆ° Bug æ‰æ˜¯å•é¡Œã€‚","æˆ‘å¯«ç¨‹å¼ä¸æ˜¯å› ç‚ºå–œæ­¡ï¼Œæ˜¯å› ç‚ºå®ƒæ¯”æˆ‘é‚„å›ºåŸ·ã€‚","äººç”Ÿå¦‚æœèƒ½ npm updateï¼Œæˆ‘æ—©å°± v99.0.0 äº†ã€‚","å‰ç«¯ build çš„é€Ÿåº¦æ¯”æˆ‘æ€è€ƒé‚„å¿«ã€‚","async/await æ˜¯äººç”Ÿå¯«ç…§ï¼šä¸€ç›´åœ¨ç­‰ï¼Œçµæœé‚„æ˜¯å ±éŒ¯ã€‚","ä¸æ˜¯æˆ‘å¹ï¼ŒRay çš„äººç”Ÿæœ€è¿‘æœ‰é» undefinedã€‚","CSS ä¸è½è©±ï¼Ÿæ­£å¸¸ï¼Œå®ƒå¾ä¾†æ²’æƒ³è½ã€‚","Figma èªªã€Œå¾®èª¿ä¸€ä¸‹ã€= å·¥ç¨‹å¸«æå¤±ä¸‰å¤©å£½å‘½ã€‚","éƒ¨è½æ ¼æ–‡ç« ä¸æ˜¯å¯«å‡ºä¾†çš„ï¼Œæ˜¯ debug å‡ºä¾†çš„ã€‚","commit message è¶Šäº‚ï¼Œä»£è¡¨äººç”Ÿè¶ŠçœŸå¯¦ã€‚","æˆ‘çš„ KPI è·Ÿ Lighthouse åˆ†æ•¸ä¸€æ¨£ï¼šèƒ½çœ‹ä½†ä¸æƒ³çœ‹ã€‚","ä»Šå¤©çš„è…¦å®¹é‡å·²æ»¿ï¼Œè«‹æ˜å¤©å† throw errorã€‚","å‰ç«¯å·¥ç¨‹å¸«æœ€å¯æ€•çš„æ•µäººï¼šè¨­è¨ˆå¸«çš„ iPhone å‹è™Ÿã€‚","æˆ‘ä¸æ˜¯ Arrayï¼Œä½†æˆ‘ä¹Ÿå¾ˆå¸¸ out of indexã€‚","ç”Ÿæ´»æ²’æœ‰ default valueï¼Œæ‰€ä»¥æ¯å¤©éƒ½åœ¨ try/catchã€‚","ç„¡æ³•é‡ç¾çš„ bugï¼Œæ°¸é æ˜¯æœ€æƒ³æ®ºæ­»ä½ çš„ bugã€‚","UI èªªã€Œæ›´åœ“ä¸€é»ã€æ™‚ï¼Œæˆ‘çš„å¿ƒä¹Ÿè·Ÿè‘—æ›´ç´¯ä¸€é»ã€‚","Ray ä¸æ˜¯ Arrayï¼Œä½†æˆ‘å¸¸è¢« join åˆ°å„ç¨®éœ€æ±‚è£¡ã€‚","å¦‚æœå·¥ç¨‹å¸«æœ‰å¤©ä½¿ï¼Œé‚£ç¥‚ä¸€å®šæ˜¯è‡ªå‹•å„²å­˜ã€‚","æˆ‘ä¸æ˜¯å¯« codeï¼Œæ˜¯è¢« code å¯«ã€‚","éµç›¤æ•²å¤ªå¤šï¼Œè¬›è©±æœƒè®Šæˆ async functionã€‚","äººç”Ÿä¹Ÿæ˜¯ SPAï¼šè·¯ç”±äº‚è·³ã€ç‹€æ…‹é›£æ§ã€cache æœƒå£ã€‚","Margin åªæ˜¯èª¿ä¸€é»ï¼Œçµæœæ•´å€‹ç‰ˆé¢çˆ†ç‚¸ã€‚","ä½ çœ‹èµ·ä¾†éœ€è¦çš„æ˜¯å’–å•¡ï¼Œä¸æ˜¯ console.logã€‚","æˆ‘ä¸æ˜¯ Arrayï¼Œä½†æˆ‘ä¹Ÿå¾ˆæƒ³è¢« deep clone åˆ°é¦¬çˆ¾åœ°å¤«ã€‚","Debug ä¸å­˜åœ¨æ™‚é–“é™åˆ¶ï¼Œå®ƒåªå­˜åœ¨ç²¾ç¥é™åˆ¶ã€‚"],
    commands: {"about":["Ray (æ˜¯ Ray ä¸æ˜¯ Array)","Frontend Developer | Tech Blogger","Loves: TypeScript, Vue, React, and Coffee â˜•"],"contact":["GitHub: https://github.com/hsiangfeng","Facebookï¼šhttps://www.facebook.com/israynotarray","Instagramï¼šhttps://www.instagram.com/isray_notarray/","Threadsï¼šhttps://www.threads.com/@isray_notarray","Email: israynotarray@gmail.com"]}
  };
</script>

      </div>
    

  </div>



    <!-- Post Navigation -->
    <nav class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-12 pt-8 border-t border-gray-200 dark:border-gray-700">
      
        <a href="/gsap/20221222/1131507457/" class="group flex flex-col p-4 rounded-xl border border-gray-200 dark:border-gray-700 hover:border-primary-500 dark:hover:border-primary-500 hover:bg-primary-50 dark:hover:bg-primary-900/20 transition-all duration-300">
          <span class="text-xs text-gray-400 mb-1 group-hover:text-primary-500 transition-colors">
            <i class="bi bi-arrow-left mr-1"></i> ä¸Šä¸€ç¯‡
          </span>
          <span class="text-gray-700 dark:text-gray-300 font-medium line-clamp-2 group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors">
            (11)å‰ç«¯å¥½å¥½ç©ç”¨ GSAP åšä¸€å€‹ç‰¹æ•ˆ - æ™‚é–“è»¸/ç·š(2)
          </span>
        </a>
      

      
        <a href="/git/20221230/27133639/" class="group flex flex-col p-4 rounded-xl border border-gray-200 dark:border-gray-700 hover:border-primary-500 dark:hover:border-primary-500 hover:bg-primary-50 dark:hover:bg-primary-900/20 transition-all duration-300 text-right">
          <span class="text-xs text-gray-400 mb-1 group-hover:text-primary-500 transition-colors">
            ä¸‹ä¸€ç¯‡ <i class="bi bi-arrow-right ml-1"></i>
          </span>
          <span class="text-gray-700 dark:text-gray-300 font-medium line-clamp-2 group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors">
            é—œæ–¼ Git çš„æª”æ¡ˆåç¨±å¤§å°å¯«å•é¡Œèˆ‡ä¿®æ­£
          </span>
        </a>
      
    </nav>
  </div>
</article>

<!-- Related Posts -->

  
  
  
    <div class="mt-8 bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700 p-6">
      <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-6 flex items-center gap-2">
        <i class="bi bi-journals text-primary-500"></i>
        ç›¸é—œæ–‡ç« 
      </h3>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
        
          <a href="/nodejs/20240101/268408973/" class="related-post-card group">
            <div class="h-full bg-gray-50 dark:bg-gray-700/50 rounded-lg border border-gray-200 dark:border-gray-600 p-4 transition-all hover:border-primary-500 dark:hover:border-primary-500 hover:shadow-md">
              <h4 class="font-medium text-gray-900 dark:text-white text-sm mb-2 line-clamp-2 group-hover:text-primary-500 transition-colors">
                å…­è§’æ—…é¤¨ API ç³»çµ±ï¼ˆfreyjaï¼‰ä¹‹å¾Œç«¯å®Œæ•´éƒ¨ç½²æ•™å­¸
              </h4>
              <p class="text-xs text-gray-500 dark:text-gray-400 flex items-center gap-1">
                <i class="bi bi-calendar3"></i>
                2024-01-01
              </p>
            </div>
          </a>
        
          <a href="/nodejs/20230504/3177278058/" class="related-post-card group">
            <div class="h-full bg-gray-50 dark:bg-gray-700/50 rounded-lg border border-gray-200 dark:border-gray-600 p-4 transition-all hover:border-primary-500 dark:hover:border-primary-500 hover:shadow-md">
              <h4 class="font-medium text-gray-900 dark:text-white text-sm mb-2 line-clamp-2 group-hover:text-primary-500 transition-colors">
                ç”¨ Express å»ºç«‹ä¸€å€‹ç°¡æ˜“ WebSocket èŠå¤©å®¤
              </h4>
              <p class="text-xs text-gray-500 dark:text-gray-400 flex items-center gap-1">
                <i class="bi bi-calendar3"></i>
                2023-05-04
              </p>
            </div>
          </a>
        
          <a href="/nodejs/20230425/1940966356/" class="related-post-card group">
            <div class="h-full bg-gray-50 dark:bg-gray-700/50 rounded-lg border border-gray-200 dark:border-gray-600 p-4 transition-all hover:border-primary-500 dark:hover:border-primary-500 hover:shadow-md">
              <h4 class="font-medium text-gray-900 dark:text-white text-sm mb-2 line-clamp-2 group-hover:text-primary-500 transition-colors">
                Express éƒ¨ç½²åˆ° Vercel
              </h4>
              <p class="text-xs text-gray-500 dark:text-gray-400 flex items-center gap-1">
                <i class="bi bi-calendar3"></i>
                2023-04-25
              </p>
            </div>
          </a>
        
          <a href="/other/20221216/786812101/" class="related-post-card group">
            <div class="h-full bg-gray-50 dark:bg-gray-700/50 rounded-lg border border-gray-200 dark:border-gray-600 p-4 transition-all hover:border-primary-500 dark:hover:border-primary-500 hover:shadow-md">
              <h4 class="font-medium text-gray-900 dark:text-white text-sm mb-2 line-clamp-2 group-hover:text-primary-500 transition-colors">
                å°‡ä½ çš„ Node.js éƒ¨ç½²åˆ° fly.io å§ï¼
              </h4>
              <p class="text-xs text-gray-500 dark:text-gray-400 flex items-center gap-1">
                <i class="bi bi-calendar3"></i>
                2022-12-16
              </p>
            </div>
          </a>
        
      </div>
    </div>
  



<!-- Social Share -->

  <div class="mt-8 bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700 p-6">
    <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-4 flex items-center gap-2">
      <i class="bi bi-share-fill text-primary-500"></i>
      åˆ†äº«é€™ç¯‡æ–‡ç« 
    </h3>
    <div class="flex flex-wrap gap-3">
      
      
      
        <button data-share="twitter" data-url="https://israynotarray.com/nodejs/20221225/1867465275/" data-title="ä¸€æ­¥ä¸€æ­¥å¸¶ä½ ç”¨ Node.js ä¸Šå‚³æª”æ¡ˆåˆ° Firebase Storage" data-hashtags="Node.js,Firebase,Express,Firebase Storage,Storage,multer,TinyPNG,Imgur" class="share-btn share-twitter">
          <i class="bi bi-twitter"></i>
          <span>Twitter</span>
        </button>
      
      
        <button data-share="facebook" data-url="https://israynotarray.com/nodejs/20221225/1867465275/" class="share-btn share-facebook">
          <i class="bi bi-facebook"></i>
          <span>Facebook</span>
        </button>
      
      
        <button data-share="linkedin" data-url="https://israynotarray.com/nodejs/20221225/1867465275/" class="share-btn share-linkedin">
          <i class="bi bi-linkedin"></i>
          <span>LinkedIn</span>
        </button>
      
      
        <button data-share="copy" data-url="https://israynotarray.com/nodejs/20221225/1867465275/" class="share-btn share-copy">
          <i class="bi bi-link-45deg"></i>
          <span>è¤‡è£½é€£çµ</span>
        </button>
      
    </div>
  </div>



<!-- Comments -->
<div class="mt-8 bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-100 dark:border-gray-700 p-6">
  <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-6">ç•™è¨€</h3>
  <div id="comments">
    <!-- Utterances Script will be injected here via theme.ts or inline script -->
    
      <script src="https://utteranc.es/client.js"
        repo="hsiangfeng/hsiangfeng.github.io"
        issue-term="pathname"
        theme="github-dark"
        crossorigin="anonymous"
        async>
      </script>
    
  </div>
</div>

      <div class="mt-16">
        <footer class="mt-12 py-8 border-t border-gray-200 dark:border-gray-800 text-center text-sm text-gray-500 dark:text-gray-400">
  
  
  
  <p>&copy; 2026 Ray. All rights reserved.</p>
  
  
  
  <p class="mt-2">
    Powered by 
    
    
    
      
      <a href="https://israynotarray.com/" target="_blank" rel="noopener" class="hover:text-primary-500">Ray Theme</a>
      
    
  </p>
  
</footer>

      </div>
    </main>

    <!-- Right Sidebar (Widgets & TOC) -->
    <aside class="w-full lg:w-1/5 p-5 lg:h-screen lg:sticky lg:top-0 hidden lg:flex flex-col overflow-y-auto border-l border-gray-200 dark:border-gray-800 bg-white dark:bg-gray-900 z-10">
      <div class="space-y-6">
  
  <!-- Search Widget (Placeholder) -->
  <!-- Search Widget -->
  <div class="relative cursor-pointer" id="search-trigger">
    <input type="text" readonly placeholder="Search..." class="w-full bg-gray-100 dark:bg-gray-800 border-none rounded-lg px-4 py-2 text-sm focus:ring-2 focus:ring-primary-500 outline-none transition-all cursor-pointer">
    <i class="bi bi-search absolute right-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
  </div>

  <!-- Table of Contents (Only on Post pages) -->
  
    <div class="bg-white dark:bg-gray-800 rounded-xl p-5 shadow-sm border border-gray-100 dark:border-gray-700">
      <h3 class="font-bold text-gray-900 dark:text-white mb-4 flex items-center text-base">
        <i class="bi bi-list-ul mr-2 text-primary-500"></i> ç›®éŒ„
      </h3>
      <div class="toc-content text-sm text-gray-600 dark:text-gray-400 max-h-[60vh] overflow-y-auto custom-scrollbar">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-text">å‰è¨€</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Firebase-%E4%BA%8B%E5%89%8D%E6%BA%96%E5%82%99"><span class="toc-text">Firebase äº‹å‰æº–å‚™</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BB%BA%E7%AB%8B-Firebase-%E5%B0%88%E6%A1%88"><span class="toc-text">å»ºç«‹ Firebase å°ˆæ¡ˆ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A8%AD%E5%AE%9A-Firebase-Storage"><span class="toc-text">è¨­å®š Firebase Storage</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%96%E5%BE%97-Firebase-Admin-SDK"><span class="toc-text">å–å¾— Firebase Admin SDK</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Express-Firebase"><span class="toc-text">Express + Firebase</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BB%BA%E7%AB%8B-Express-%E5%B0%88%E6%A1%88"><span class="toc-text">å»ºç«‹ Express å°ˆæ¡ˆ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BB%BA%E7%AB%8B-upload-%E8%B3%87%E6%96%99%E5%A4%BE"><span class="toc-text">å»ºç«‹ upload è³‡æ–™å¤¾</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%9D%E7%9B%B8%E9%97%9C%E5%A5%97%E4%BB%B6"><span class="toc-text">å®‰è£ç›¸é—œå¥—ä»¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BB%BA%E7%AB%8B-env-%E6%AA%94%E6%A1%88"><span class="toc-text">å»ºç«‹ .env æª”æ¡ˆ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%A6%E4%BD%9C%E4%B8%8A%E5%82%B3%E5%8A%9F%E8%83%BD"><span class="toc-text">å¯¦ä½œä¸Šå‚³åŠŸèƒ½</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8A%E5%82%B3%E6%AA%94%E6%A1%88"><span class="toc-text">ä¸Šå‚³æª”æ¡ˆ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%96%E5%BE%97%E6%AA%94%E6%A1%88%E7%B6%B2%E5%9D%80"><span class="toc-text">å–å¾—æª”æ¡ˆç¶²å€</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%AA%E9%99%A4%E6%AA%94%E6%A1%88"><span class="toc-text">åˆªé™¤æª”æ¡ˆ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%96%E5%BE%97%E6%AA%94%E6%A1%88%E5%90%8D%E7%A8%B1%E5%88%97%E8%A1%A8"><span class="toc-text">å–å¾—æª”æ¡ˆåç¨±åˆ—è¡¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%87%E5%AE%9A%E4%B8%8A%E5%82%B3%E6%AA%94%E6%A1%88%E5%88%B0%E7%89%B9%E5%AE%9A%E8%B3%87%E6%96%99%E5%A4%BE"><span class="toc-text">æŒ‡å®šä¸Šå‚³æª”æ¡ˆåˆ°ç‰¹å®šè³‡æ–™å¤¾</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%AD%E9%80%94%E5%B0%8F%E7%B5%90"><span class="toc-text">ä¸­é€”å°çµ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%A0%E7%A2%BC%E8%A3%9C%E5%85%85"><span class="toc-text">åŠ ç¢¼è£œå……</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%87%8D%E6%96%B0%E5%91%BD%E5%90%8D%E6%AA%94%E6%A1%88"><span class="toc-text">é‡æ–°å‘½åæª”æ¡ˆ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A3%93%E7%B8%AE%E5%9C%96%E7%89%87-TinyPNG"><span class="toc-text">å£“ç¸®åœ–ç‰‡(TinyPNG)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B5%90%E8%AB%96"><span class="toc-text">çµè«–</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%83%E8%80%83%E6%96%87%E7%8D%BB"><span class="toc-text">åƒè€ƒæ–‡ç»</span></a></li></ol>
      </div>
    </div>
  

  <!-- Ad Widget (Google Ads) -->
  
    <div class="bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm border border-gray-100 dark:border-gray-700 min-h-[300px] overflow-hidden relative">
      <!-- Fallback Text (Visible when AdBlock is on) -->
      <div class="absolute inset-0 flex items-center justify-center p-4 text-center">
        <p class="text-xs text-gray-400 dark:text-gray-500 leading-relaxed">
          æ•´ç†é€™äº›æŠ€è¡“ç­†è¨˜çœŸçš„å¾ˆèŠ±æ™‚é–“ï¼Œå¦‚æœä½ é¡˜æ„ <strong>é—œé–‰ Adblock</strong> æ”¯æŒæˆ‘ï¼Œæˆ‘æœƒæŠŠé€™ä»½æ„Ÿè¬è½‰æ›æˆæ›´å¤šã€Œè¸©å‘è½‰é¿å‘ã€çš„å…§å®¹çµ¦ä½ ï¼ãƒ½(ãƒ»âˆ€ãƒ»)ï¾‰
        </p>
      </div>
      <!-- Ad Unit (z-index higher than fallback) -->
      <div class="relative z-10 w-full min-h-[280px]">
        <span class="text-xs text-gray-400 uppercase tracking-wider block mb-2">Advertisement</span>
        <!-- ArrayException_Sidebar -->
        <ins class="adsbygoogle"
             style="display:block;min-width:300px;width:100%;"
             data-ad-client="ca-pub-4319471747130190"
             data-ad-slot="9970366113"
             data-ad-format="auto"
             data-full-width-responsive="true"></ins>
        <script>
             (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      </div>
    </div>
  

  <!-- Recent Posts -->
  <div class="bg-white dark:bg-gray-800 rounded-xl p-5 shadow-sm border border-gray-100 dark:border-gray-700">
    <h3 class="font-bold text-gray-900 dark:text-white mb-4 flex items-center text-base">
      <i class="bi bi-newspaper mr-2 text-primary-500"></i> æœ€æ–°æ–‡ç« 
    </h3>
    <div class="space-y-2">
      
        
        <a href="/git/20260122/21277993/" 
           class="block p-3 rounded-lg border border-transparent hover:border-primary-200 dark:hover:border-primary-800 hover:bg-primary-50/50 dark:hover:bg-primary-900/10 transition-all duration-300 group hover:-translate-y-0.5 hover:shadow-md">
          
          <h4 class="text-sm font-medium text-gray-800 dark:text-gray-200 line-clamp-2 leading-snug mb-2 group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors">
            Git init å‡ºç¾ master åˆ†æ”¯æç¤ºï¼Ÿæ•™ä½ è¨­å®šé è¨­åˆ†æ”¯ç‚º main
          </h4>
          
          <!-- Meta Info -->
          <div class="flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400">
            <span class="flex items-center gap-1">
              <i class="bi bi-calendar3 text-[10px]"></i>
              01/22
            </span>
            <span class="text-gray-300 dark:text-gray-600">â€¢</span>
            <span class="flex items-center gap-1">
              <i class="bi bi-clock text-[10px]"></i>
              6 åˆ†é˜
            </span>
          </div>
        </a>
      
        
        <a href="/ai/20260122/2316436852/" 
           class="block p-3 rounded-lg border border-transparent hover:border-primary-200 dark:hover:border-primary-800 hover:bg-primary-50/50 dark:hover:bg-primary-900/10 transition-all duration-300 group hover:-translate-y-0.5 hover:shadow-md">
          
          <h4 class="text-sm font-medium text-gray-800 dark:text-gray-200 line-clamp-2 leading-snug mb-2 group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors">
            ç”¨ Dev Containers æ‰“é€  AI è‡ªå‹•åŒ–é–‹ç™¼çš„å®‰å…¨éš”é›¢ç’°å¢ƒ
          </h4>
          
          <!-- Meta Info -->
          <div class="flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400">
            <span class="flex items-center gap-1">
              <i class="bi bi-calendar3 text-[10px]"></i>
              01/22
            </span>
            <span class="text-gray-300 dark:text-gray-600">â€¢</span>
            <span class="flex items-center gap-1">
              <i class="bi bi-clock text-[10px]"></i>
              14 åˆ†é˜
            </span>
          </div>
        </a>
      
        
        <a href="/git/20260121/2025687513/" 
           class="block p-3 rounded-lg border border-transparent hover:border-primary-200 dark:hover:border-primary-800 hover:bg-primary-50/50 dark:hover:bg-primary-900/10 transition-all duration-300 group hover:-translate-y-0.5 hover:shadow-md">
          
          <h4 class="text-sm font-medium text-gray-800 dark:text-gray-200 line-clamp-2 leading-snug mb-2 group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors">
            Git Worktree æ˜¯ä»€éº¼ï¼Ÿä¸€å€‹å°ˆæ¡ˆåŒæ™‚è·‘å¤šå€‹ AI Agent çš„ç§˜è¨£
          </h4>
          
          <!-- Meta Info -->
          <div class="flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400">
            <span class="flex items-center gap-1">
              <i class="bi bi-calendar3 text-[10px]"></i>
              01/21
            </span>
            <span class="text-gray-300 dark:text-gray-600">â€¢</span>
            <span class="flex items-center gap-1">
              <i class="bi bi-clock text-[10px]"></i>
              13 åˆ†é˜
            </span>
          </div>
        </a>
      
        
        <a href="/other/20260121/695717014/" 
           class="block p-3 rounded-lg border border-transparent hover:border-primary-200 dark:hover:border-primary-800 hover:bg-primary-50/50 dark:hover:bg-primary-900/10 transition-all duration-300 group hover:-translate-y-0.5 hover:shadow-md">
          
          <h4 class="text-sm font-medium text-gray-800 dark:text-gray-200 line-clamp-2 leading-snug mb-2 group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors">
            Chrome ä¸€ç›´å¿«å–ï¼ˆCacheï¼‰è³‡æ–™ï¼Ÿæ•™ä½ ä¸‰æ‹›å¿«é€Ÿæ¸…é™¤ï¼
          </h4>
          
          <!-- Meta Info -->
          <div class="flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400">
            <span class="flex items-center gap-1">
              <i class="bi bi-calendar3 text-[10px]"></i>
              01/21
            </span>
            <span class="text-gray-300 dark:text-gray-600">â€¢</span>
            <span class="flex items-center gap-1">
              <i class="bi bi-clock text-[10px]"></i>
              6 åˆ†é˜
            </span>
          </div>
        </a>
      
        
        <a href="/ai/20260120/4189755271/" 
           class="block p-3 rounded-lg border border-transparent hover:border-primary-200 dark:hover:border-primary-800 hover:bg-primary-50/50 dark:hover:bg-primary-900/10 transition-all duration-300 group hover:-translate-y-0.5 hover:shadow-md">
          
          <h4 class="text-sm font-medium text-gray-800 dark:text-gray-200 line-clamp-2 leading-snug mb-2 group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors">
            æ¯” MCP æ›´çœ Token çš„ Agent Skills - ç”¨ Claude Code ç¤ºç¯„
          </h4>
          
          <!-- Meta Info -->
          <div class="flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400">
            <span class="flex items-center gap-1">
              <i class="bi bi-calendar3 text-[10px]"></i>
              01/20
            </span>
            <span class="text-gray-300 dark:text-gray-600">â€¢</span>
            <span class="flex items-center gap-1">
              <i class="bi bi-clock text-[10px]"></i>
              35 åˆ†é˜
            </span>
          </div>
        </a>
      
    </div>
  </div>



  <!-- Fake Login Trigger -->
  <div class="text-center mt-8 pb-4">
    <a href="#" id="fake-login-trigger" class="text-[10px] text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 transition-colors font-mono tracking-widest hover:opacity-100">
      ADMIN_ACCESS
    </a>
  </div>

</div>

    </aside>

  </div>



  <!-- Search Modal -->
  <div id="search-modal" class="fixed inset-0 z-[100] hidden" aria-labelledby="modal-title" role="dialog" aria-modal="true">
    <!-- Background overlay -->
    <div id="search-overlay" class="fixed inset-0 bg-gray-900/60 backdrop-blur-sm transition-opacity pointer-events-none"></div>

    <!-- Modal panel -->
    <div class="fixed inset-0 z-10 overflow-y-auto">
      <div class="flex min-h-full items-start justify-center p-4 sm:p-6 md:p-20">
        <div class="relative w-full max-w-2xl transform overflow-hidden rounded-2xl bg-white dark:bg-gray-900 shadow-2xl transition-all border border-gray-100 dark:border-gray-800">
          
          <!-- Header -->
          <div class="relative px-6 pt-6 pb-4 border-b border-gray-100 dark:border-gray-800">
            <div class="flex items-center justify-between mb-4">
              <h3 class="text-xl font-bold text-gray-900 dark:text-white flex items-center gap-2">
                <i class="bi bi-search text-primary-500"></i>
                æœå°‹æ–‡ç« 
              </h3>
              <button id="close-search" class="text-gray-400 hover:text-gray-500 dark:hover:text-gray-300 transition-colors p-1 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800">
                <span class="sr-only">Close</span>
                <i class="bi bi-x-lg text-lg"></i>
              </button>
            </div>
            <div id="search-box" class="w-full"></div>
          </div>

          <!-- Results Area -->
          <div class="px-6 py-4 min-h-[300px] max-h-[60vh] overflow-y-auto custom-scrollbar bg-white dark:bg-gray-900">
            <div id="hits" class="space-y-4"></div>
            <div id="pagination" class="mt-8 flex justify-center pb-4"></div>
          </div>
          
          <!-- Footer -->
          <div class="bg-gray-50 dark:bg-gray-800/50 px-6 py-3 flex items-center justify-between border-t border-gray-100 dark:border-gray-800">
            <div id="stats" class="text-xs text-gray-500 dark:text-gray-400"></div>
            <div class="flex items-center gap-4">
              <div class="hidden sm:flex items-center gap-2 text-xs text-gray-400">
                <span class="px-1.5 py-0.5 rounded border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800">Esc</span> to close
                <span class="px-1.5 py-0.5 rounded border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800">Cmd K</span> to open
              </div>
              <div class="flex items-center gap-1 text-xs text-gray-400">
                <span>Powered by</span>
                <i class="bi bi-algolia text-blue-500"></i>
                <span>Algolia</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Load Search Script -->
  <script>
    
    window.algoliaConfig = {
      appId: 'MU7N4K4R36',
      apiKey: '110ed15d0a4842310bafc6fdfda119c4',
      indexName: 'blog'
    };
    
    
    window.themeConfig = {
      reading_progress: {
        enable: true,
        position: 'top',
        color: '#37c6c0',
        height: '3px'
      },
      back2top: {
        enable: true,
        scrollpercent: true
      }
    };
  </script>
  
  
<script src="/js/search-BWjLIi5W.js"></script>

  

</body>
</html>
