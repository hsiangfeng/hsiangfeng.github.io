function o(){return typeof window.gtag=="function"}function l(){const n=document.querySelector("#search-input");if(n&&o()){let e;n.addEventListener("input",t=>{const a=t.target.value.trim();a.length>=3&&(clearTimeout(e),e=window.setTimeout(()=>{window.gtag("event","search",{search_term:a})},1e3))})}}function s(){const n=document.querySelectorAll("[data-share-platform]");n.length&&o()&&n.forEach(e=>{e.addEventListener("click",function(){const t=this.getAttribute("data-share-platform"),a=this.getAttribute("data-share-url")||window.location.href;window.gtag("event","share",{method:t,content_type:"article",item_id:a})})})}function u(){o()&&document.addEventListener("click",n=>{let e=n.target;for(;e&&e.tagName!=="A";)e=e.parentElement;if(!e||e.tagName!=="A")return;const t=e.getAttribute("href");if(!t)return;t.startsWith("http")&&!t.includes(window.location.hostname)&&window.gtag("event","click",{event_category:"outbound",event_label:t,transport_type:"beacon"})})}function g(){const n=document.getElementById("theme-toggle");n&&o()&&n.addEventListener("click",()=>{const t=document.documentElement.classList.contains("dark")?"light":"dark";window.gtag("event","theme_change",{event_category:"engagement",event_label:t})})}function d(){if(!o())return;const n=[25,50,75,100],e=[],t=()=>{const a=window.scrollY,c=document.documentElement.scrollHeight-window.innerHeight,r=Math.round(a/c*100);n.forEach(i=>{r>=i&&!e.includes(i)&&(e.push(i),window.gtag("event","scroll",{event_category:"engagement",event_label:`${i}%`,value:i}))})};window.addEventListener("scroll",t,{passive:!0})}function m(){if(!o()||!document.querySelector("article"))return;const n=Date.now();let e=!1,t=!1,a=!1;setInterval(()=>{const r=Math.floor((Date.now()-n)/1e3);r>=30&&!e&&(e=!0,window.gtag("event","reading_time",{event_category:"engagement",event_label:"30_seconds",value:30})),r>=60&&!t&&(t=!0,window.gtag("event","reading_time",{event_category:"engagement",event_label:"1_minute",value:60})),r>=120&&!a&&(a=!0,window.gtag("event","reading_time",{event_category:"engagement",event_label:"2_minutes",value:120}))},5e3)}function h(){setTimeout(()=>{l(),s(),u(),g(),d(),m()},1e3)}export{h as initAnalytics};
